---
title: 'ржЖржкржирж╛рж░ рж╕ржорзНржнржмржд Effect ржкрзНрж░рзЯрзЛржЬржи ржирж╛ржУ рж╣рждрзЗ ржкрж╛рж░рзЗ'
---

<Intro>

ржПржлрзЗржХрзНржЯ рж╣рж▓ рж░рж┐ржпрж╝рзНржпрж╛ржХрзНржЯ ржкрзНржпрж╛рж░рж╛ржбрж╛ржЗржо ржерзЗржХрзЗ ржмрзЗрж░рж┐ржпрж╝рзЗ ржЖрж╕рж╛рж░ ржПржХржЯрж┐ ржорж╛ржзрзНржпржоред ржПржЧрзБрж▓рж┐ ржЖржкржирж╛ржХрзЗ рж░рж┐ржпрж╝рзНржпрж╛ржХрзНржЯрзЗрж░ ржмрж╛ржЗрж░рзЗ ржЧрж┐ржпрж╝рзЗ ржХрж┐ржЫрзБ ржмрж╛рж╣рзНржпрж┐ржХ рж╕рж┐рж╕рзНржЯрзЗржо ржпрзЗржоржи ржХрзЛржирзЛ ржиржи-рж░рж┐ржпрж╝рзНржпрж╛ржХрзНржЯ ржЙржЗржЬрзЗржЯ, ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржмрж╛ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗрж░ DOM-ржПрж░ рж╕рж╛ржерзЗ ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рждрзЗ ржжрзЗржпрж╝ред ржпржжрж┐ ржХрзЛржирзЛ ржмрж╛рж╣рзНржпрж┐ржХ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирж╛ ржерж╛ржХрзЗ (ржпрзЗржоржи, ржХрж┐ржЫрзБ ржкрзНрж░ржкрж╕ ржмрж╛ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржЪрж╛ржи), рждрж╛рж╣рж▓рзЗ ржЗржлрзЗржХрзНржЯ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржмрзЗ ржирж╛ред ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЗржлрзЗржХрзНржЯ ржЕржкрж╕рж╛рж░ржг ржХрж░рж▓рзЗ ржЖржкржирж╛рж░ ржХрзЛржб ржЕржирзБрж╕рж░ржг ржХрж░рж╛ рж╕рж╣ржЬ рж╣ржмрзЗ, ржжрзНрж░рзБржд ржЪрж▓ржмрзЗ ржПржмржВ ржХржо рждрзНрж░рзБржЯрж┐ ржкрзНрж░ржмржг рж╣ржмрзЗред

</Intro>

<YouWillLearn>

* ржХрзЗржи ржПржмржВ ржХрзАржнрж╛ржмрзЗ ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЗржлрзЗржХрзНржЯ ржерзЗржХрзЗ ржЕржкрж╕рж╛рж░ржг ржХрж░ржмрзЗржи
* ржЗржлрзЗржХрзНржЯ ржЫрж╛ржбрж╝рж╛ржЗ ржнрж╛рж░рж┐ ржХржорзНржкрж┐ржЙржЯрзЗрж╢ржи ржХрзАржнрж╛ржмрзЗ ржХрзНржпрж╛рж╢ ржХрж░ржмрзЗржи
* ржЗржлрзЗржХрзНржЯ ржЫрж╛ржбрж╝рж╛ржЗ ржХрзАржнрж╛ржмрзЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржПржмржВ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░ржмрзЗржи
* ржХрзАржнрж╛ржмрзЗ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗрж░ ржоржзрзНржпрзЗ рж▓ржЬрж┐ржХ ржнрж╛ржЧ ржХрж░ржмрзЗржи
* ржХрзЛржи рж▓ржЬрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░ ржХрж░рж╛ ржЙржЪрж┐ржд
* ржХрзАржнрж╛ржмрзЗ ржкрж░рж┐ржмрж░рзНрждржи рж╕ржорзНржкрж░рзНржХрзЗ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржЬрж╛ржирж╛ржмрзЗржи

</YouWillLearn>

## ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЗржлрзЗржХрзНржЯ ржХрзАржнрж╛ржмрзЗ ржЕржкрж╕рж╛рж░ржг ржХрж░ржмрзЗржи {/*how-to-remove-unnecessary-effects*/}

ржП ржжрзБржЯрж┐ рж╕рж╛ржзрж╛рж░ржг ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржпрж╝ ржирж╛:

* **рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржбрзЗржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржХрж░рждрзЗ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред** ржзрж░рзБржи, ржЖржкржирж┐ ржПржХржЯрж┐ рждрж╛рж▓рж┐ржХрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржи ржкрзНрж░ржжрж░рзНрж╢ржирзЗрж░ ржЖржЧрзЗред ржПржЦрж╛ржирзЗ рждрж╛рж▓рж┐ржХрж╛ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржЗржлрзЗржХрзНржЯ рж▓рж┐ржЦрзЗ ржПржХржЯрж┐ рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЪрж┐ржирзНрждрж╛ ржЖрж╕рждрзЗ ржкрж╛рж░рзЗред рждржмрзЗ ржПржЯрж┐ ржЕржХрж╛рж░рзНржпржХрж░ред рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ рж╣рж▓рзЗ, React ржкрзНрж░ржержорзЗ ржХржорзНржкрзЛржирзЗржирзНржЯ ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ ржХрж▓ ржХрж░рзЗ ржарж┐ржХ ржХрж░рзЗ ржХрзА рж╕рзНржХрзНрж░рж┐ржирзЗ ржжрзЗржЦрж╛ржирзЛ рж╣ржмрзЗред ржПрж░ржкрж░ React рж╕рзЗржЗ ржкрж░рж┐ржмрж░рзНрждржиржЧрзБрж▓рзЛ DOM-ржП ["ржХржорж┐ржЯ"](/learn/render-and-commit) ржХрж░рзЗ рж╕рзНржХрзНрж░рж┐ржи ржЖржкржбрзЗржЯ ржХрж░рзЗред рждрж╛рж░ржкрж░ React ржЗржлрзЗржХрзНржЯржЧрзБрж▓рзЛ ржЪрж╛рж▓рж╛ржпрж╝ред ржпржжрж┐ ржЗржлрзЗржХрзНржЯ рждрзОржХрзНрж╖ржгрж╛рзО рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗ, рждрж╛рж╣рж▓рзЗ ржкрзБрж░рзЛ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржЖржмрж╛рж░ рж╢рзБрж░рзБ рж╣ржмрзЗ! ржПржЗ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржкрж╛рж╕ ржПржбрж╝рж╛рждрзЗ, рж╕ржм ржбрзЗржЯрж╛ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╢рзАрж░рзНрж╖ рж╕рзНрждрж░рзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзБржиред ржЖржкржирж╛рж░ ржкрзНрж░ржкрж╕ ржмрж╛ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржПржЗ ржХрзЛржб рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржкрзБржирж░рж╛ржпрж╝ ржЪрж▓ржмрзЗред

* **ржЗржЙржЬрж╛рж░ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓ ржХрж░рждрзЗ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред** ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржЖржкржирж┐ ржЪрж╛ржЗржЫрзЗржи ржпрзЗ ржЗржЙржЬрж╛рж░ ржХрзЛржирзЛ ржкржгрзНржп ржХрж┐ржирж▓рзЗ ржПржХржЯрж┐ `/api/buy` POST рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗ ржПржмржВ ржПржХржЯрж┐ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржжрзЗржЦрж╛ржирзЛ рж╣ржмрзЗред Buy ржмрзЛрждрж╛ржорзЗрж░ ржХрзНрж▓рж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ, ржЖржкржирж┐ ржЬрж╛ржирзЗржи ржХрзА ржШржЯрзЗржЫрзЗред ржЗржлрзЗржХрзНржЯ ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕ржоржпрж╝, ржЖржкржирж┐ ржЬрж╛ржирзЗржи ржирж╛ *ржарж┐ржХ ржХрзА* ржЗржЙржЬрж╛рж░ ржХрж░рзЗржЫрзЗржи (ржпрзЗржоржи, ржХрзЛржи ржмрзЛрждрж╛ржоржЯрж┐ ржХрзНрж▓рж┐ржХ рж╣ржпрж╝рзЗржЫрзЗ)ред ржП ржХрж╛рж░ржгрзЗржЗ рж╕рж╛ржзрж╛рж░ржгржд ржЗржЙржЬрж╛рж░ ржЗржнрзЗржирзНржЯржЧрзБрж▓рзЛ рж╕ржВрж╢рзНрж▓рж┐рж╖рзНржЯ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж╣рзНржпрж╛ржирзНржбрж▓ ржХрж░рж╛ рж╣ржпрж╝ред

ржЖржкржирж╛ржХрзЗ ржмрж╛рж╣рзНржпрж┐ржХ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ рж╕рж╛ржерзЗ [рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ](/learn/synchronizing-with-effects#what-are-effects-and-how-are-they-different-from-events) ржХрж░рждрзЗ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржиред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржЖржкржирж┐ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯ рж▓рж┐ржЦрзЗ ржПржХржЯрж┐ jQuery ржЙржЗржЬрзЗржЯржХрзЗ React рж╕рзНржЯрзЗржЯрзЗрж░ рж╕рж╛ржерзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рзЗржиред ржПржЫрж╛ржбрж╝рж╛ржУ, ржЗржлрзЗржХрзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рж╛ ржпрж╛ржпрж╝: ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржмрж░рзНрждржорж╛ржи рж╕рж╛рж░рзНржЪ ржХрзБржпрж╝рзЗрж░рж┐рж░ рж╕рж╛ржерзЗ рж╕рж╛рж░рзНржЪ рж░рзЗржЬрж╛рж▓рзНржЯржХрзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржоржирзЗ рж░рж╛ржЦржмрзЗржи, ржЖржзрзБржирж┐ржХ [ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХржЧрзБрж▓рзЛ](/learn/start-a-new-react-project#production-grade-react-frameworks) рж╕рж░рж╛рж╕рж░рж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржЗржлрзЗржХрзНржЯ рж▓рзЗржЦрж╛рж░ ржЪрзЗржпрж╝рзЗ ржЖрж░ржУ ржПржлрж┐рж╢рж┐рзЯрзЗржирзНржЯ ржмрж┐рж▓рзНржЯ-ржЗржи ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ ржкржжрзНржзрждрж┐ ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

рж╕ржарж┐ржХ ржзрж╛рж░ржгрж╛ ржЧржбрж╝рзЗ рждрзБрж▓рждрзЗ, ржЖрж╕рзБржи ржХрж┐ржЫрзБ рж╕рж╛ржзрж╛рж░ржг ржЙржжрж╛рж╣рж░ржг ржжрзЗржЦрж┐!

### ржкрзНрж░ржкрж╕ ржмрж╛ рж╕рзНржЯрзЗржЯрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж╛ {/*updating-state-based-on-props-or-state*/}

ржзрж░рзБржи, ржЖржкржирж╛рж░ ржПржХржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржжрзБржЯрж┐ рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ рж░ржпрж╝рзЗржЫрзЗ: `firstName` ржПржмржВ `lastName`ред ржЖржкржирж┐ ржПржЧрзБрж▓рзЛ ржпрзЛржЧ ржХрж░рзЗ ржПржХржЯрж┐ `fullName` рждрзИрж░рж┐ ржХрж░рждрзЗ ржЪрж╛ржиред ржПрж░ ржкрж╛рж╢рж╛ржкрж╛рж╢рж┐, `firstName` ржмрж╛ `lastName` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ `fullName` ржЖржкржбрзЗржЯ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред ржЖржкржирж╛рж░ ржкрзНрж░ржержо ржзрж╛рж░ржгрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗ ржПржХржЯрж┐ `fullName` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржпрзЛржЧ ржХрж░рж╛ ржПржмржВ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗ ржПржЯрж┐ ржЖржкржбрзЗржЯ ржХрж░рж╛:

```js {5-9}
function Form() {
  const [firstName, setFirstName] = useState('Taylor');
  const [lastName, setLastName] = useState('Swift');

  // ЁЯФ┤ Avoid: redundant state and unnecessary Effect
  const [fullName, setFullName] = useState('');
  useEffect(() => {
    setFullName(firstName + ' ' + lastName);
  }, [firstName, lastName]);
  // ...
}
```

ржПржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЬржирзЗрж░ рждрзБрж▓ржирж╛ржпрж╝ ржмрзЗрж╢рж┐ ржЬржЯрж┐рж▓ ржПржмржВ ржЕржХрж╛рж░рзНржпржХрж░: ржПржЯрж┐ `fullName` ржПрж░ ржкрзБрж░ржирзЛ ржорж╛ржи ржжрж┐ржпрж╝рзЗ ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг рж░рзЗржирзНржбрж╛рж░ ржкрж╛рж╕ ржХрж░рзЗ, рждрж╛рж░ржкрж░ ржЖржкржбрзЗржЯ рж╣ржУржпрж╝рж╛ ржорж╛ржи ржирж┐ржпрж╝рзЗ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗред рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржПржмржВ ржЗржлрзЗржХрзНржЯржЯрж┐ рж╕рж░рж┐ржпрж╝рзЗ ржжрж┐ржи:

```js {4-5}
function Form() {
  const [firstName, setFirstName] = useState('Taylor');
  const [lastName, setLastName] = useState('Swift');
  // тЬЕ Good: calculated during rendering
  const fullName = firstName + ' ' + lastName;
  // ...
}
```

**ржпржЦржи ржХрж┐ржЫрзБ ржмрж┐ржжрзНржпржорж╛ржи ржкрзНрж░ржкрж╕ ржмрж╛ рж╕рзНржЯрзЗржЯ ржерзЗржХрзЗ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗржЯ ржХрж░рж╛ ржпрж╛ржпрж╝, рждржЦржи [рж╕рзНржЯрзЗржЯрзЗ ржПржЯрж┐ рж░рж╛ржЦржмрзЗржи ржирж╛.](/learn/choosing-the-state-structure#avoid-redundant-state) ржкрж░рж┐ржмрж░рзНрждрзЗ, ржПржЯрж┐ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗржЯ ржХрж░рзБржиред** ржПрж░ ржлрж▓рзЗ ржЖржкржирж╛рж░ ржХрзЛржб ржжрзНрж░рзБрждрждрж░ рж╣ржпрж╝ (ржЖржкржирж┐ ржЕрждрж┐рж░рж┐ржХрзНржд "ржХрзНржпрж╛рж╕ржХрзЗржбрж┐ржВ" ржЖржкржбрзЗржЯ ржПржбрж╝рж┐ржпрж╝рзЗ ржпрж╛ржи), рж╕рж╣ржЬрждрж░ рж╣ржпрж╝ (ржХрж┐ржЫрзБ ржХрзЛржб ржЕржкрж╕рж╛рж░ржг ржХрж░рзЗржи), ржПржмржВ ржХржо рждрзНрж░рзБржЯрж┐ ржкрзНрж░ржмржг рж╣ржпрж╝ (ржнрж┐ржирзНржи рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗрж░ рж╕рж╛ржерзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬрзЗрж╢ржи рж╕ржорж╕рзНржпрж╛ ржПржбрж╝рж╛ржи)ред ржпржжрж┐ ржПржЗ ржкржжрзНржзрждрж┐ ржЖржкржирж╛рж░ ржЬржирзНржп ржирждрзБржи ржоржирзЗ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ [Thinking in React](/learn/thinking-in-react#step-3-find-the-minimal-but-complete-representation-of-ui-state) ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рзЗ ржХрзА ржХрзА рж╕рзНржЯрзЗржЯрзЗ ржерж╛ржХрж╛ ржЙржЪрж┐рждред

### ржнрж╛рж░рж┐ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржиржЧрзБрж▓рж┐ ржХрзНржпрж╛рж╢ ржХрж░рж╛ {/*caching-expensive-calculations*/}

ржПржЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ `todos` ржкрзНрж░ржкрж╕ ржерзЗржХрзЗ ржкрж╛ржУржпрж╝рж╛ ржЯрж╛рж╕рзНржХржЧрзБрж▓рзЛржХрзЗ ржирж┐ржпрж╝рзЗ `visibleTodos` ржЧржгржирж╛ ржХрж░рзЗ ржПржмржВ рж╕рзЗржЧрзБрж▓рзЛржХрзЗ `filter` ржкрзНрж░ржкрж╕ ржЕржирзБржпрж╛ржпрж╝рзА ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзЗред ржЖржкржирж┐ ржоржирзЗ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржлрж▓рж╛ржлрж▓ржЯрж┐ рж╕рзНржЯрзЗржЯрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛ ржЙржЪрж┐ржд ржПржмржВ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯ ржерзЗржХрзЗ ржПржЯрж┐ ржЖржкржбрзЗржЯ ржХрж░рж╛ ржЙржЪрж┐ржд:

```js {4-8}
function TodoList({ todos, filter }) {
  const [newTodo, setNewTodo] = useState('');

  // ЁЯФ┤ Avoid: redundant state and unnecessary Effect
  const [visibleTodos, setVisibleTodos] = useState([]);
  useEffect(() => {
    setVisibleTodos(getFilteredTodos(todos, filter));
  }, [todos, filter]);

  // ...
}
```

ржкрзВрж░рзНржмржмрж░рзНрждрзА ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржорждрзЛ, ржПржЯрж┐ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржПржмржВ ржЕржХрж╛рж░рзНржпржХрж░ред ржкрзНрж░ржержорзЗ, рж╕рзНржЯрзЗржЯ ржПржмржВ ржЗржлрзЗржХрзНржЯржЯрж┐ ржЕржкрж╕рж╛рж░ржг ржХрж░рзБржи:

```js {3-4}
function TodoList({ todos, filter }) {
  const [newTodo, setNewTodo] = useState('');
  // тЬЕ This is fine if getFilteredTodos() is not slow.
  const visibleTodos = getFilteredTodos(todos, filter);
  // ...
}
```

рж╕рж╛ржзрж╛рж░ржгржд, ржПржЗ ржХрзЛржбржЯрж┐ ржарж┐ржХ ржЖржЫрзЗ! рждржмрзЗ рж╣ржпрж╝рждрзЛ `getFilteredTodos()` ржзрзАрж░ ржЧрждрж┐рж░ ржЕржержмрж╛ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржЕржирзЗржХ `todos` рж░ржпрж╝рзЗржЫрзЗред ржП ржХрзНрж╖рзЗрждрзНрж░рзЗ, ржЖржкржирж┐ ржЪрж╛ржи ржирж╛ ржпрзЗ ржХрж┐ржЫрзБ ржЕрж╕ржорзНржкрж░рзНржХрж┐ржд рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржпрзЗржоржи `newTodo` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ `getFilteredTodos()` ржкрзБржирж░рж╛ржпрж╝ ржЧржгржирж╛ ржХрж░рж╛ рж╣рзЛржХред

ржЖржкржирж┐ ржПржХржЯрж┐ ржнрж╛рж░рж┐ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржи ржХрзНржпрж╛рж╢ (ржЕржержмрж╛ ["ржорзЗржорзЛржЗржЬ"](https://en.wikipedia.org/wiki/Memoization)) ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржЯрж┐ [`useMemo`](/reference/react/useMemo) рж╣рзБржХрзЗрж░ ржоржзрзНржпрзЗ рж╕рзНржерж╛ржкржи ржХрж░рзЗ:

```js {5-8}
import { useMemo, useState } from 'react';

function TodoList({ todos, filter }) {
  const [newTodo, setNewTodo] = useState('');
  const visibleTodos = useMemo(() => {
    // тЬЕ Does not re-run unless todos or filter change
    return getFilteredTodos(todos, filter);
  }, [todos, filter]);
  // ...
}
```

ржЕржержмрж╛, ржПржХ рж▓рж╛ржЗржирзЗ рж▓рзЗржЦрж╛:

```js {5-6}
import { useMemo, useState } from 'react';

function TodoList({ todos, filter }) {
  const [newTodo, setNewTodo] = useState('');
  // тЬЕ Does not re-run getFilteredTodos() unless todos or filter change
  const visibleTodos = useMemo(() => getFilteredTodos(todos, filter), [todos, filter]);
  // ...
}
```

**ржПржЯрж┐ React-ржХрзЗ ржЬрж╛ржирж╛ржпрж╝ ржпрзЗ ржЖржкржирж┐ ржЪрж╛ржи ржирж╛ ржпрзЗ ржЕржнрзНржпржирзНрждрж░рзАржг ржлрж╛ржВрж╢ржиржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ ржЪрж▓рзБржХ ржпрждржХрзНрж╖ржг ржирж╛ `todos` ржЕржержмрж╛ `filter` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝ред** React ржкрзНрж░ржержо рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржоржпрж╝ `getFilteredTodos()` ржПрж░ рж░рж┐ржЯрж╛рж░рзНржи ржнрзНржпрж╛рж▓рзБ ржоржирзЗ рж░рж╛ржЦржмрзЗред ржкрж░ржмрж░рзНрждрзА рж░рзЗржирзНржбрж╛рж░ржЧрзБрж▓рж┐рждрзЗ, ржПржЯрж┐ ржЪрзЗржХ ржХрж░ржмрзЗ ржпрзЗ `todos` ржЕржержмрж╛ `filter` ржнрж┐ржирзНржи ржХрж┐ржирж╛ред ржпржжрж┐ рж╕рзЗржЧрзБрж▓рзЛ ржЖржЧрзЗрж░ ржорждрзЛ ржПржХржЗ ржерж╛ржХрзЗ, рждржмрзЗ `useMemo` рж╕рж░рзНржмрж╢рзЗрж╖ ржлрж▓рж╛ржлрж▓ржЯрж┐ ржлрж┐рж░рж┐ржпрж╝рзЗ ржжрзЗржмрзЗ ржпрж╛ ржПржЯрж┐ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗржЫрзЗред ржХрж┐ржирзНрждрзБ ржпржжрж┐ рж╕рзЗржЧрзБрж▓рзЛ ржнрж┐ржирзНржи рж╣ржпрж╝, рждржмрзЗ React ржЖржмрж╛рж░ ржЕржнрзНржпржирзНрждрж░рзАржг ржлрж╛ржВрж╢ржиржЯрж┐ржХрзЗ ржХрж▓ ржХрж░ржмрзЗ (ржПржмржВ ржПрж░ ржлрж▓рж╛ржлрж▓ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░ржмрзЗ)ред

ржпрзЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржЖржкржирж┐ [`useMemo`](/reference/react/useMemo) ржПрж░ ржоржзрзНржпрзЗ рж░рж╛ржЦрзЗржи рждрж╛ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржЪрж▓рзЗ, рждрж╛ржЗ ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ [рж╢рзБржжрзНржз ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржирзЗрж░ ржЬржирзНржп](/learn/keeping-components-pure) ржХрж╛ржЬ ржХрж░рзЗред

<DeepDive>

#### ржХрзАржнрж╛ржмрзЗ ржЬрж╛ржирж╛ ржпрж╛ржмрзЗ ржпрзЗ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржиржЯрж┐ ржнрж╛рж░рж┐ ржХрж┐ржирж╛? {/*how-to-tell-if-a-calculation-is-expensive*/}

рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржпрждржХрзНрж╖ржи ржирж╛ ржЖржкржирж┐ рж╣рж╛ржЬрж╛рж░ рж╣рж╛ржЬрж╛рж░ ржЕржмржЬрзЗржХрзНржЯ рждрзИрж░рж┐ ржХрж░ржЫрзЗржи ржмрж╛ рж▓рзБржк ржХрж░ржЫрзЗржи, ржПржЯрж┐ рж╕ржорзНржнржмржд ржнрж╛рж░рж┐ ржиржпрж╝ред ржпржжрж┐ ржЖржкржирж┐ ржЖрж░ржУ ржирж┐рж╢рзНржЪрж┐ржд рж╣рждрзЗ ржЪрж╛ржи, рждрж╛рж╣рж▓рзЗ ржПржХржЯрж┐ ржХржирж╕рзЛрж▓ рж▓ржЧ ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржХрзЛржбрзЗрж░ ржПржХржЯрж┐ ржЕржВрж╢рзЗ рж╕ржоржпрж╝ ржкрж░рж┐ржорж╛ржк ржХрж░рждрзЗ:

```js {1,3}
console.time('filter array');
const visibleTodos = getFilteredTodos(todos, filter);
console.timeEnd('filter array');
```

ржЖржкржирж╛рж░ ржкрж░рж┐ржорж╛ржк ржХрж░рж╛ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржиржЯрж┐ рж╕ржорзНржкрж╛ржжржи ржХрж░рзБржи(ржпрзЗржоржи, ржЗржиржкрзБржЯрзЗ ржЯрж╛ржЗржк ржХрж░рж╛)ред ржПрж░ржкрж░ ржХржирж╕рзЛрж▓рзЗ `filter array: 0.15ms` ржПрж░ ржорждрзЛ рж▓ржЧ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржиред ржпржжрж┐ рж╕рж╛ржоржЧрзНрж░рж┐ржХ рж▓ржЧ ржХрж░рж╛ рж╕ржоржпрж╝ ржПржХржЯрж┐ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржкрж░рж┐ржорж╛ржгрзЗ (ржпрзЗржоржи, `1ms` ржмрж╛ рждрж╛рж░ ржмрзЗрж╢рж┐) рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ рж╕рзЗржЗ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржЯрж┐ ржорзЗржорзЛржЗржЬ ржХрж░рж╛ ржЕрж░рзНржержкрзВрж░рзНржг рж╣рждрзЗ ржкрж╛рж░рзЗред ржкрж░рзАржХрзНрж╖рж╛ рж╣рж┐рж╕рзЗржмрзЗ, ржЖржкржирж┐ рждрж╛рж░ржкрж░ ржХрзНржпрж╛рж▓рзНржХрзБрж▓рзЗрж╢ржЯрж┐ `useMemo` ржПрж░ ржоржзрзНржпрзЗ ржЖржмрзГржд ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржмржВ ржпрж╛ржЪрж╛ржЗ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ рж╕рзЗржЗ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржирзЗрж░ ржЬржирзНржп ржорзЛржЯ рж▓ржЧ ржХрж░рж╛ рж╕ржоржпрж╝ ржХржорзЗржЫрзЗ ржХрж┐ржирж╛:

```js
console.time('filter array');
const visibleTodos = useMemo(() => {
  return getFilteredTodos(todos, filter); // Skipped if todos and filter haven't changed
}, [todos, filter]);
console.timeEnd('filter array');
```
`useMemo` *ржкрзНрж░ржержо* рж░рзЗржирзНржбрж╛рж░ржЯрж┐ ржжрзНрж░рзБржд ржХрж░ржмрзЗ ржирж╛ред ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЖржкржбрзЗржЯрзЗ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрж╛ржЬ ржПржбрж╝рж╛рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред

ржоржирзЗ рж░рж╛ржЦржмрзЗржи, ржЖржкржирж╛рж░ ржорзЗрж╢рж┐ржи рж╣ржпрж╝рждрзЛ ржЖржкржирж╛рж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ рждрзБрж▓ржирж╛ржпрж╝ ржжрзНрж░рзБржд, рждрж╛ржЗ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржкрж░рзАржХрзНрж╖рж╛рж░ ржЬржирзНржп ржХрзГрждрзНрж░рж┐ржоржнрж╛ржмрзЗ ржзрзАрж░ржЧрждрж┐рждрзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ ржнрж╛рж▓рзЛред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, Chrome ржП ржПржХржЯрж┐ [CPU Throttling](https://developer.chrome.com/blog/new-in-devtools-61/#throttling) ржЕржкрж╢ржи ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

ржПржЫрж╛ржбрж╝рж╛ржУ ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржкрж░рж┐ржорж╛ржк ржХрж░рж╛ рж╕ржмржЪрзЗржпрж╝рзЗ рж╕ржарж┐ржХ ржлрж▓рж╛ржлрж▓ ржжрзЗржмрзЗ ржирж╛ред (ржпрзЗржоржи, [Strict Mode](/reference/react/StrictMode) ржЪрж╛рж▓рзБ ржерж╛ржХрж▓рзЗ ржЖржкржирж┐ ржкрзНрж░рждрж┐ржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж░рзЗржирзНржбрж╛рж░ ржПржХржмрж╛рж░рзЗрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ ржжрзБржЗржмрж╛рж░ ржжрзЗржЦржмрзЗржиред) рж╕ржмржЪрзЗржпрж╝рзЗ рж╕ржарж┐ржХ ржЯрж╛ржЗржорж┐ржВ ржкрзЗрждрзЗ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкржЯрж┐ ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗрж░ ржЬржирзНржп рждрзИрж░рж┐ ржХрж░рзБржи ржПржмржВ ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржорждрзЛ ржбрж┐ржнрж╛ржЗрж╕рзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржиред

</DeepDive>

### ржкрзНрж░ржк ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ рж╕ржорж╕рзНржд рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛ {/*resetting-all-state-when-a-prop-changes*/}

ржПржЗ `ProfilePage` ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржХржЯрж┐ `userId` ржкрзНрж░ржк ржЧрзНрж░рж╣ржг ржХрж░рзЗред ржкрзЗржЬржЯрж┐рждрзЗ ржПржХржЯрж┐ ржоржирзНрждржмрзНржп ржЗржиржкрзБржЯ рж░ржпрж╝рзЗржЫрзЗ, ржПржмржВ ржЖржкржирж┐ ржПрж░ ржорж╛ржи рж╕ржВрж░ржХрзНрж╖ржгрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ `comment` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржиред ржПржХржжрж┐ржи, ржЖржкржирж┐ ржПржХржЯрж┐ рж╕ржорж╕рзНржпрж╛ рж▓ржХрзНрж╖рзНржп ржХрж░рзЗржи: ржпржЦржи ржЖржкржирж┐ ржПржХ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржЕржирзНржп ржкрзНрж░рзЛржлрж╛ржЗрж▓рзЗ ржпрж╛ржи, `comment` рж╕рзНржЯрзЗржЯржЯрж┐ рж░рж┐рж╕рзЗржЯ рж╣ржпрж╝ ржирж╛ред ржлрж▓рзЗ, ржнрзБрж▓ ржХрж░рзЗ ржЕржирзНржп ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржкрзНрж░рзЛржлрж╛ржЗрж▓рзЗ ржоржирзНрждржмрзНржп ржкрзЛрж╕рзНржЯ ржХрж░рж╛ рж╕рж╣ржЬ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ред ржПржЗ рж╕ржорж╕рзНржпрж╛ржЯрж┐ рж╕ржорж╛ржзрж╛ржи ржХрж░рждрзЗ, ржЖржкржирж┐ ржЪрж╛ржи ржпрзЗ `userId` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ `comment` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ ржкрж░рж┐рж╖рзНржХрж╛рж░ рж╣ржпрж╝рзЗ ржпрж╛ржХред

```js {4-7}
export default function ProfilePage({ userId }) {
  const [comment, setComment] = useState('');

  // ЁЯФ┤ Avoid: Resetting state on prop change in an Effect
  useEffect(() => {
    setComment('');
  }, [userId]);
  // ...
}
```

ржПржЯрж┐ ржЕржХрж╛рж░рзНржпржХрж░ ржХрж╛рж░ржг `ProfilePage` ржПржмржВ ржПрж░ ржЪрж╛ржЗрж▓рзНржбрж░рж╛ ржкрзНрж░ржержорзЗ ржкрзБрж░ржирзЛ ржорж╛ржи ржжрж┐ржпрж╝рзЗ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗ, ржПржмржВ рждрж╛рж░ржкрж░ ржЖржмрж╛рж░ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗред ржПржЯрж┐ ржЬржЯрж┐рж▓ржУ ржХрж╛рж░ржг ржЖржкржирж╛ржХрзЗ `ProfilePage`-ржПрж░ ржнрж┐рждрж░рзЗ ржерж╛ржХрж╛ ржкрзНрж░рждрж┐ржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯрзЗржУ ржПржХржЗ ржХрж╛ржЬ ржХрж░рждрзЗ рж╣ржмрзЗред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржпржжрж┐ ржоржирзНрждржмрзНржпрзЗрж░ UIржЯрж┐ ржирзЗрж╕рзНржЯрзЗржб ржерж╛ржХрзЗ, рждржмрзЗ ржЖржкржирж╛ржХрзЗ ржирзЗрж╕рзНржЯрзЗржб ржоржирзНрждржмрзНржпрзЗрж░ рж╕рзНржЯрзЗржЯржУ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗред

ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ, ржЖржкржирж┐ React-ржХрзЗ ржЬрж╛ржирж╛рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржзрж╛рж░ржгрж╛ржЧрждржнрж╛ржмрзЗ ржПржХржЯрж┐ _ржнрж┐ржирзНржи_ ржкрзНрж░рзЛржлрж╛ржЗрж▓, `key` ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржжрзБржЯрж┐ ржнрж╛ржЧрзЗ ржнрж╛ржЧ ржХрж░рзБржи ржПржмржВ ржмрж╛ржЗрж░рзЗрж░ ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ ржнрж┐рждрж░рзЗрж░ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржПржХржЯрж┐ `key` ржЕрзНржпрж╛ржЯрзНрж░рж┐ржмрж┐ржЙржЯ ржкрж╛рж╕ ржХрж░рзБржи:

```js {5,11-12}
export default function ProfilePage({ userId }) {
  return (
    <Profile
      userId={userId}
      key={userId}
    />
  );
}

function Profile({ userId }) {
  // тЬЕ This and any other state below will reset on key change automatically
  const [comment, setComment] = useState('');
  // ...
}
```

рж╕рж╛ржзрж╛рж░ржгржд, ржПржХржЗ рж╕рзНржерж╛ржирзЗ ржПржХржЗ ржХржорзНржкрзЛржирзЗржирзНржЯ рж░рзЗржирзНржбрж╛рж░ рж╣рж▓рзЗ React рж╕рзНржЯрзЗржЯ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗред **`Profile` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ `userId`-ржХрзЗ `key` рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛рж╕ ржХрж░рж▓рзЗ, ржЖржкржирж┐ React-ржХрзЗ ржмрж▓ржЫрзЗржи ржпрзЗ ржмрж┐ржнрж┐ржирзНржи `userId` рж╕рж╣ ржжрзБржЯрж┐ `Profile` ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржЖрж▓рж╛ржжрж╛ ржХржорзНржкрзЛржирзЗржирзНржЯ рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рждрзЗ, ржпрзЗржЧрзБрж▓рзЛрж░ рж╕рзНржЯрзЗржЯ рж╢рзЗржпрж╝рж╛рж░ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржиржпрж╝ред** ржпржЦржиржЗ `key` (ржпрзЗржЯрж┐ ржЖржкржирж┐ `userId` рж╣рж┐рж╕рзЗржмрзЗ рж╕рзЗржЯ ржХрж░рзЗржЫрзЗржи) ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, React `Profile` ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржмржВ ржПрж░ рж╕ржм ржЪрж╛ржЗрж▓рзНржбрзЗрж░ DOM ржкрзБржирж░рж╛ржпрж╝ рждрзИрж░рж┐ ржХрж░ржмрзЗ ржПржмржВ [рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░ржмрзЗ](/learn/preserving-and-resetting-state#option-2-resetting-state-with-a-key)ред ржПржЦржи ржкрзНрж░рзЛржлрж╛ржЗрж▓рзЗрж░ ржоржзрзНржпрзЗ ржирзЗржнрж┐ржЧрзЗржЯ ржХрж░рж╛рж░ рж╕ржоржпрж╝ `comment` ржлрж┐рж▓рзНржб рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рж╕рж╛ржл рж╣ржпрж╝рзЗ ржпрж╛ржмрзЗред

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, рж╢рзБржзрзБржорж╛рждрзНрж░ ржмрж╛ржЗрж░рзЗрж░ `ProfilePage` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржкрзНрж░рзЛржЬрзЗржХрзНржЯрзЗрж░ ржЕржирзНржпрж╛ржирзНржп ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржжрзГрж╢рзНржпржорж╛ржиред `ProfilePage`-ржХрзЗ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛрж░ `key` ржкрж╛рж╕ ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗ: рждрж╛рж░рж╛ `userId`-ржХрзЗ ржПржХржЯрж┐ рж╕рж╛ржзрж╛рж░ржг ржкрзНрж░ржк рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛рж╕ ржХрж░рзЗред `ProfilePage` ржПржЯрж┐ржХрзЗ `key` рж╣рж┐рж╕рзЗржмрзЗ ржнрж┐рждрж░рзЗрж░ `Profile` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржкрж╛рж╕ ржХрж░рзЗ, ржпрж╛ ржПржХржЯрж┐ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи ржбрж┐ржЯрзЗржЗрж▓ред

### ржкрзНрж░ржк ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржХрж┐ржЫрзБ рж╕рзНржЯрзЗржЯ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рж╛ {/*adjusting-some-state-when-a-prop-changes*/}

ржХржЦржиржУ ржХржЦржиржУ, ржкрзНрж░ржк ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржЖржкржирж┐ рж╕рзНржЯрзЗржЯрзЗрж░ ржПржХржЯрж┐ ржЕржВрж╢ рж░рж┐рж╕рзЗржЯ ржмрж╛ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рждрзЗ ржЪрж╛ржЗрждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ ржкрзБрж░рзЛржЯрж╛ ржиржпрж╝ред

ржПржЗ `List` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржПржХржЯрж┐ `items` ржПрж░ рждрж╛рж▓рж┐ржХрж╛ ржкрзНрж░ржк рж╣рж┐рж╕рзЗржмрзЗ ржЧрзНрж░рж╣ржг ржХрж░рзЗ ржПржмржВ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржЖржЗржЯрзЗржоржЯрж┐ `selection` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗ рж░рж╛ржЦрзЗред ржЖржкржирж┐ ржЪрж╛ржи ржпржЦржиржЗ `items` ржкрзНрж░ржк ржПржХржЯрж┐ ржнрж┐ржирзНржи ржЕрзНржпрж╛рж░рзЗ ржЧрзНрж░рж╣ржг ржХрж░ржмрзЗ, `selection` ржХрзЗ `null` ржП рж░рж┐рж╕рзЗржЯ ржХрж░рждрзЗ:

```js {5-8}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // ЁЯФ┤ Avoid: Adjusting state on prop change in an Effect
  useEffect(() => {
    setSelection(null);
  }, [items]);
  // ...
}
```

ржПржЯрж┐ржУ ржЖржжрж░рзНрж╢ ржиржпрж╝ред ржкрзНрж░рждрж┐ ржмрж╛рж░ `items` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ, ржкрзНрж░ржержорзЗ `List` ржПржмржВ ржПрж░ ржЪрж╛ржЗрж▓рзНржб ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛ ржкрзБрж░ржирзЛ `selection` ржорж╛ржи ржирж┐ржпрж╝рзЗ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗред рждрж╛рж░ржкрж░ React DOM ржЖржкржбрзЗржЯ ржХрж░ржмрзЗ ржПржмржВ Effects ржЪрж╛рж▓рж╛ржмрзЗред рж╢рзЗрж╖рзЗ `setSelection(null)` ржХрж▓ржЯрж┐ `List` ржПржмржВ ржПрж░ ржЪрж╛ржЗрж▓рзНржб ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржХрж░ржмрзЗ, ржпрж╛ ржкрзБрж░рзЛ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржЯрж┐ ржЖржмрж╛рж░ рж╢рзБрж░рзБ ржХрж░ржмрзЗред

Effect ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржорж╛ржзрзНржпржорзЗ рж╢рзБрж░рзБ ржХрж░рзБржиред ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ, рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ рж╕рзНржЯрзЗржЯржЯрж┐ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рзБржиред

```js {5-11}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // Better: Adjust the state while rendering
  const [prevItems, setPrevItems] = useState(items);
  if (items !== prevItems) {
    setPrevItems(items);
    setSelection(null);
  }
  // ...
}
```

[ржЖржЧрзЗрж░ рж░рзЗржирзНржбрж╛рж░ ржерзЗржХрзЗ рждржерзНржп рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛](/reference/react/useState#storing-information-from-previous-renders) ржПржнрж╛ржмрзЗ ржмрзЛржЭрж╛ ржХржарж┐ржи рж╣рждрзЗ ржкрж╛рж░рзЗ, ржХрж┐ржирзНрждрзБ ржПржЯрж┐ ржПржХржЗ рж╕рзНржЯрзЗржЯржХрзЗ ржПржХржЯрж┐ Effect-ржП ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЪрзЗржпрж╝рзЗ ржнрж╛рж▓рзЛред ржЙржкрж░рзЛржХрзНржд ржЙржжрж╛рж╣рж░ржгрзЗ, `setSelection` рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░ ржЪрж▓рж╛ржХрж╛рж▓рзАржи ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред React `return` рж╕рзНржЯрзЗржЯржорзЗржирзНржЯрзЗрж░ ржкрж░рзЗ `List`-ржХрзЗ *рждрж╛рзОржХрзНрж╖ржгрж┐ржХржнрж╛ржмрзЗ* ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржХрж░ржмрзЗред React ржПржЦржиржУ `List`-ржПрж░ ржЪрж╛ржЗрж▓рзНржбржжрзЗрж░ рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗржирж┐ ржмрж╛ DOM ржЖржкржбрзЗржЯ ржХрж░рзЗржирж┐, рждрж╛ржЗ ржПржЯрж┐ `List`-ржПрж░ ржЪрж╛ржЗрж▓рзНржбржжрзЗрж░ ржкрзБрж░ржирзЛ `selection` ржорж╛ржи рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛ ржПржбрж╝рж╛рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред

ржпржЦржи ржЖржкржирж┐ ржПржХржЯрж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржоржпрж╝ ржХржорзНржкрзЛржирзЗржирзНржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗржи, React рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ JSX ржлрзЗрж▓рзЗ ржжрзЗржпрж╝ ржПржмржВ рждрж╛рзОржХрзНрж╖ржгрж┐ржХржнрж╛ржмрзЗ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗред ржЦрзБржм ржзрзАрж░ ржЧрждрж┐рж░ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ ржПржбрж╝рж╛рждрзЗ, React ржХрзЗржмрж▓ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржоржпрж╝ *ржПржХржЗ* ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржжрзЗржпрж╝ред ржпржжрж┐ ржЖржкржирж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржоржпрж╝ ржЕржирзНржп ржХрзЛржирзЛ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗржи, рждрж╛рж╣рж▓рзЗ ржПржХржЯрж┐ рждрзНрж░рзБржЯрж┐ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржиред ржПржХржЯрж┐ рж╢рж░рзНржд ржпрзЗржоржи `items !== prevItems` рж▓рзБржк ржПржбрж╝рж╛ржирзЛрж░ ржЬржирзНржп ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ред ржЖржкржирж┐ ржПржнрж╛ржмрзЗ рж╕рзНржЯрзЗржЯ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ DOM ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ ржмрж╛ ржЯрж╛ржЗржоржЖржЙржЯ рж╕рзЗржЯ ржХрж░рж╛рж░ ржорждрзЛ ржпрзЗржХрзЛржирзЛ рж╕рж╛ржЗржб ржЗржлрзЗржХрзНржЯ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ ржмрж╛ Effect-ржП ржерж╛ржХрж╛ ржЙржЪрж┐ржд [ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржкрж┐ржУрж░ рж░рж╛ржЦрж╛рж░ ржЬржирзНржпред](/learn/keeping-components-pure)

**ржпржжрж┐ржУ ржПржЗ ржкрзНржпрж╛ржЯрж╛рж░рзНржиржЯрж┐ ржПржХржЯрж┐ Effect-ржПрж░ ржЪрзЗржпрж╝рзЗ ржЖрж░ржУ ржХрж╛рж░рзНржпржХрж░, ржмрзЗрж╢рж┐рж░ржнрж╛ржЧ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ ржПржЯрж┐ржУ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржпрж╝ ржирж╛ред** ржпрзЗржнрж╛ржмрзЗржЗ ржХрж░рзБржи ржирж╛ ржХрзЗржи, ржкрзНрж░ржк ржмрж╛ ржЕржирзНржп ржХрзЛржирзЛ рж╕рзНржЯрзЗржЯрзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ рж╕рзНржЯрзЗржЯ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рж╛ ржЖржкржирж╛рж░ ржбрзЗржЯрж╛ ржлрзНрж▓рзЛ ржмрзБржЭрждрзЗ ржПржмржВ ржбрж┐ржмрж╛ржЧ ржХрж░рждрзЗ ржЖрж░ржУ ржХржарж┐ржи ржХрж░рзЗ рждрзЛрж▓рзЗред рж╕рж░рзНржмржжрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи ржпрзЗ ржЖржкржирж┐ [ржПржХржЯрж┐ key ржжрж┐ржпрж╝рзЗ рж╕ржорж╕рзНржд рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржХрж┐ ржирж╛](#resetting-all-state-when-a-prop-changes) ржмрж╛ [рж░рзЗржирзНржбрж╛рж░рж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ рж╕ржмржХрж┐ржЫрзБ ржЧржгржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржХрж┐ ржирж╛](#updating-state-based-on-props-or-state)ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржирж┐рж░рзНржмрж╛ржЪрж┐ржд *item* рж╕ржВрж░ржХрзНрж╖ржг ржПржмржВ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛рж░ ржкрж░рж┐ржмрж░рзНрждрзЗ ржЖржкржирж┐ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд *item ID* рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:

```js {3-5}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selectedId, setSelectedId] = useState(null);
  // тЬЕ Best: Calculate everything during rendering
  const selection = items.find(item => item.id === selectedId) ?? null;
  // ...
}
```

ржПржЦржи рж╕рзНржЯрзЗржЯ "рж╕рж╛ржоржЮрзНржЬрж╕рзНржп" ржХрж░рж╛рж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ID рж╕рж╣ ржЖржЗржЯрзЗржоржЯрж┐ рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржерж╛ржХрж▓рзЗ, ржПржЯрж┐ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржерж╛ржХржмрзЗред ржпржжрж┐ ржПржЯрж┐ ржирж╛ ржерж╛ржХрзЗ, рждржмрзЗ рж░рзЗржирзНржбрж╛рж░рж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ ржЧржгржирж╛ ржХрж░рж╛ `selection` рж╣ржмрзЗ `null` ржХрж╛рж░ржг ржХрзЛржирзЛ ржорзЗрж▓рж╛ржирзЛ ржЖржЗржЯрзЗржо ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐ред ржПржЗ ржЖржЪрж░ржгржЯрж┐ ржнрж┐ржирзНржи, ржХрж┐ржирзНрждрзБ ржПржЯрж┐ ржпрзБржХрзНрждрж┐рж╕ржЩрзНржЧрждржнрж╛ржмрзЗ ржнрж╛рж▓рзЛ, ржХрж╛рж░ржг `items` ржПрж░ ржмрзЗрж╢рж┐рж░ржнрж╛ржЧ ржкрж░рж┐ржмрж░рзНрждржи рж╕рж┐рж▓рзЗржХрж╢ржХрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗред

### ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ржЧрзБрж▓рж┐рж░ ржоржзрзНржпрзЗ рж▓ржЬрж┐ржХ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рж╛ {/*sharing-logic-between-event-handlers*/}

ржзрж░рж┐, ржЖржкржирж╛рж░ ржПржХржЯрж┐ ржкржгрзНржп ржкрзГрж╖рзНржарж╛ ржЖржЫрзЗ ржпрж╛рж░ ржжрзБржЗржЯрж┐ ржмрзЛрждрж╛ржо (Buy ржПржмржВ Checkout) ржЖржЫрзЗ, ржпрзЗржЧрзБрж▓рзЛ ржЙржнржпрж╝рзЗржЗ рж╕рзЗржЗ ржкржгрзНржпржЯрж┐ ржХрзЗржирж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗржпрж╝ред ржЖржкржирж┐ ржЪрж╛ржи ржпрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржкржгрзНржпржЯрж┐ ржХрж╛рж░рзНржЯрзЗ рж░рж╛ржЦрж▓рзЗржЗ ржПржХржЯрж┐ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржжрзЗржЦрж╛ржирзЛ рж╣рзЛржХред ржЙржнржпрж╝ ржмрзЛрждрж╛ржорзЗрж░ ржХрзНрж▓рж┐ржХ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ржЧрзБрж▓рж┐рждрзЗ `showNotification()` ржХрж▓ ржХрж░рж╛ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐рж░ ржорждрзЛ ржоржирзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ, рждрж╛ржЗ ржЖржкржирж┐ ржПржЗ рж▓ржЬрж┐ржХржЯрж┐ ржПржХржЯрж┐ Effect-ржП рж░рж╛ржЦрждрзЗ рж▓рзЛржнрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗржи:

```js {2-7}
function ProductPage({ product, addToCart }) {
  // ЁЯФ┤ Avoid: Event-specific logic inside an Effect
  useEffect(() => {
    if (product.isInCart) {
      showNotification(`Added ${product.name} to the shopping cart!`);
    }
  }, [product]);

  function handleBuyClick() {
    addToCart(product);
  }

  function handleCheckoutClick() {
    addToCart(product);
    navigateTo('/checkout');
  }
  // ...
}
```

ржПржЗ Effect ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ред ржПржЯрж┐ рж╕ржорзНржнржмржд ржмрж╛ржЧржУ рж╕рзГрж╖рзНржЯрж┐ ржХрж░ржмрзЗред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржзрж░рзБржи ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкржЯрж┐ ржкрзГрж╖рзНржарж╛ рж░рж┐ржлрзНрж░рзЗрж╢рзЗрж░ ржоржзрзНржпрзЗ рж╢ржкрж┐ржВ ржХрж╛рж░рзНржЯржЯрж┐ "ржоржирзЗ рж░рж╛ржЦрзЗ"ред ржпржжрж┐ ржЖржкржирж┐ ржПржХржмрж╛рж░ ржПржХржЯрж┐ ржкржгрзНржп ржХрж╛рж░рзНржЯрзЗ ржпрзЛржЧ ржХрж░рзЗржи ржПржмржВ ржкрзГрж╖рзНржарж╛ рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░рзЗржи, рждржмрзЗ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржЖржмрж╛рж░ржУ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗред ржПржЗ ржкржгрзНржпржЯрж┐рж░ ржкрзГрж╖рзНржарж╛ржЯрж┐ рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржПржЯрж┐ ржкрзНрж░рждрж┐ржмрж╛рж░ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗред ржПрж░ ржХрж╛рж░ржг рж╣рж▓ `product.isInCart` ржкрзГрж╖рзНржарж╛ рж▓рзЛржбрзЗрж░ рж╕ржоржпрж╝ ржЗрждрж┐ржоржзрзНржпрзЗржЗ `true` ржерж╛ржХржмрзЗ, рждрж╛ржЗ ржЙржкрж░рзЗ ржЙрж▓рзНрж▓рзЗржЦрж┐ржд Effect `showNotification()` ржХрж▓ ржХрж░ржмрзЗред

**ржпржЦржи ржЖржкржирж┐ ржирж┐рж╢рзНржЪрж┐ржд ржирж╛ рж╣ржи ржпрзЗ ржХрзЛржи ржХрзЛржбржЯрж┐ Effect-ржП ржерж╛ржХрж╛ ржЙржЪрж┐ржд ржмрж╛ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ, рждржЦржи ржирж┐ржЬрзЗржХрзЗ ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзБржи *ржХрзЗржи* ржПржЗ ржХрзЛржбржЯрж┐ ржЪрж▓рждрзЗ рж╣ржмрзЗред рж╢рзБржзрзБ рж╕рзЗржЗ ржХрзЛржбрзЗрж░ ржЬржирзНржп Effects ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи ржпрж╛ *ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржЬржирзНржп* ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржУржпрж╝рж╛рж░ ржХрж╛рж░ржгрзЗ ржЪрж▓рждрзЗ рж╣ржмрзЗред** ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржиржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА *ржмрзЛрждрж╛ржоржЯрж┐ ржЪрж╛ржкрж╛рж░* ржХрж╛рж░ржгрзЗ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд, ржкрзГрж╖рзНржарж╛ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржУржпрж╝рж╛рж░ ржХрж╛рж░ржгрзЗ ржиржпрж╝! Effect ржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржи ржПржмржВ ржЙржнржпрж╝ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржлрж╛ржВрж╢ржирзЗ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж▓ржЬрж┐ржХржЯрж┐ рж░рж╛ржЦрзБржи:

```js {2-6,9,13}
function ProductPage({ product, addToCart }) {
  // тЬЕ Good: Event-specific logic is called from event handlers
  function buyProduct() {
    addToCart(product);
    showNotification(`Added ${product.name} to the shopping cart!`);
  }

  function handleBuyClick() {
    buyProduct();
  }

  function handleCheckoutClick() {
    buyProduct();
    navigateTo('/checkout');
  }
  // ...
}
```

ржПржЯрж┐ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ Effect ржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзЗ ржПржмржВ ржмрж╛ржЧржЯрж┐ржУ ржарж┐ржХ ржХрж░рзЗред

### ржкрзЛрж╕рзНржЯ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржирзЛ {/*sending-a-post-request*/}

ржПржЗ `Form` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржжрзБржЯрж┐ ржзрж░ржирзЗрж░ POST ржЕржирзБрж░рзЛржз ржкрж╛ржарж╛ржпрж╝ред ржПржЯрж┐ ржорж╛ржЙржирзНржЯ рж╣ржУржпрж╝рж╛рж░ рж╕ржоржпрж╝ ржПржХржЯрж┐ ржЕрзНржпрж╛ржирж╛рж▓рж┐ржЯрж┐ржХрзНрж╕ ржЗржнрзЗржирзНржЯ ржкрж╛ржарж╛ржпрж╝ред ржлрж░рзНржоржЯрж┐ ржкрзВрж░ржг ржХрж░рзЗ ржпржЦржи ржЖржкржирж┐ рж╕рж╛ржмржорж┐ржЯ ржмрзЛрждрж╛ржоржЯрж┐ ржХрзНрж▓рж┐ржХ ржХрж░рзЗржи, ржПржЯрж┐ `/api/register` ржПржирзНржбржкржпрж╝рзЗржирзНржЯрзЗ ржПржХржЯрж┐ POST ржЕржирзБрж░рзЛржз ржкрж╛ржарж╛ржмрзЗ:

```js {5-8,10-16}
function Form() {
  const [firstName, setFirstName] = useState('');
  const [lastName, setLastName] = useState('');

  // тЬЕ Good: This logic should run because the component was displayed
  useEffect(() => {
    post('/analytics/event', { eventName: 'visit_form' });
  }, []);

  // ЁЯФ┤ Avoid: Event-specific logic inside an Effect
  const [jsonToSubmit, setJsonToSubmit] = useState(null);
  useEffect(() => {
    if (jsonToSubmit !== null) {
      post('/api/register', jsonToSubmit);
    }
  }, [jsonToSubmit]);

  function handleSubmit(e) {
    e.preventDefault();
    setJsonToSubmit({ firstName, lastName });
  }
  // ...
}
```

ржЖржЧрзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржорждрзЛ ржПржХржЗ ржорж╛ржиржжржгрзНржб ржПржЦрж╛ржирзЗ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржпрж╛ржХред

ржЕрзНржпрж╛ржирж╛рж▓рж┐ржЯрж┐ржХрзНрж╕ POST ржЕржирзБрж░рзЛржзржЯрж┐ Effect ржП ржерж╛ржХрж╛ ржЙржЪрж┐рждред ржПрж░ ржХрж╛рж░ржг рж╣рж▓рзЛ ржЕрзНржпрж╛ржирж╛рж▓рж┐ржЯрж┐ржХрзНрж╕ ржЗржнрзЗржирзНржЯржЯрж┐ ржкрж╛ржарж╛ржирзЛрж░ ржЙржжрзНржжрзЗрж╢рзНржп рж╣рж▓ ржлрж░рзНржоржЯрж┐ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржпрж╝рзЗржЫрзЗред (ржПржЯрж┐ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржжрзБржЗржмрж╛рж░ ржЪрж▓ржмрзЗ, рждржмрзЗ ржХрзАржнрж╛ржмрзЗ ржПржЯрж┐ рж╕рж╛ржорж▓рж╛рждрзЗ рж╣ржпрж╝, рждрж╛ ржЬрж╛ржирждрзЗ [ржПржЦрж╛ржирзЗ ржжрзЗржЦрзБржи](/learn/synchronizing-with-effects#sending-analytics)ред)

рждржмрзЗ, `/api/register` POST ржЕржирзБрж░рзЛржзржЯрж┐ ржлрж░рзНржоржЯрж┐ _ржкрзНрж░ржжрж░рзНрж╢рж┐ржд_ рж╣ржУржпрж╝рж╛рж░ ржХрж╛рж░ржгрзЗ рж╣ржпрж╝ ржирж╛ред ржЖржкржирж┐ ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорзБрж╣рзВрж░рзНрждрзЗ ржкрж╛ржарж╛рждрзЗ ржЪрж╛ржи: ржпржЦржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзЛрждрж╛ржоржЯрж┐ ржЪрж╛ржкрзЗржиред ржПржЯрж┐ рж╢рзБржзрзБ _рж╕рзЗржЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржирзЗ_ ржШржЯржмрзЗред ржжрзНржмрж┐рждрзАржпрж╝ Effect ржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржи ржПржмржВ рж╕рзЗржЗ POST ржЕржирзБрж░рзЛржзржЯрж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж╕рж░рж┐ржпрж╝рзЗ ржирж┐ржиред

```js {12-13}
function Form() {
  const [firstName, setFirstName] = useState('');
  const [lastName, setLastName] = useState('');

  // тЬЕ Good: This logic runs because the component was displayed
  useEffect(() => {
    post('/analytics/event', { eventName: 'visit_form' });
  }, []);

  function handleSubmit(e) {
    e.preventDefault();
    // тЬЕ Good: Event-specific logic is in the event handler
    post('/api/register', { firstName, lastName });
  }
  // ...
}
```

ржХрзЛржирзЛ рж▓ржЬрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ ржмрж╛ Effect-ржП рж░рж╛ржЦржмрзЗржи ржХрж┐ ржирж╛ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржкрзНрж░ржзрж╛ржи ржкрзНрж░рж╢рзНржиржЯрж┐ рж╣рж▓рзЛ ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ _ржХрж┐рж╕рзЗрж░ рж▓ржЬрж┐ржХ_ред ржпржжрж┐ ржПржЗ рж▓ржЬрж┐ржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржПржХржЯрж┐ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржирзЗрж░ ржХрж╛рж░ржгрзЗ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржПржЯрж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж░рж╛ржЦрзБржиред ржЖрж░ ржпржжрж┐ ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ рж╕рзНржХрзНрж░рж┐ржирзЗ _ржжрзЗржЦрж╛рж░_ ржХрж╛рж░ржгрзЗ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржПржЯрж┐ Effect-ржП рж░рж╛ржЦрзБржиред

### ржЧрж╛ржгрж┐рждрж┐ржХ ржХрзНрж░ржо {/*chains-of-computations*/}

ржХржЦржирзЛ ржХржЦржирзЛ ржЖржкржирж┐ ржПржХрж╛ржзрж┐ржХ Effect ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрзНрж░рж▓рзБржмрзНржз рж╣рждрзЗ ржкрж╛рж░рзЗржи, ржпрзЗржЦрж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж┐ Effect ржЕржирзНржп ржХрзЛржирзЛ state ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржПржХржЯрж┐ state рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рзЗ:

```js {7-29}
function Game() {
  const [card, setCard] = useState(null);
  const [goldCardCount, setGoldCardCount] = useState(0);
  const [round, setRound] = useState(1);
  const [isGameOver, setIsGameOver] = useState(false);

  // ЁЯФ┤ Avoid: Chains of Effects that adjust the state solely to trigger each other
  useEffect(() => {
    if (card !== null && card.gold) {
      setGoldCardCount(c => c + 1);
    }
  }, [card]);

  useEffect(() => {
    if (goldCardCount > 3) {
      setRound(r => r + 1)
      setGoldCardCount(0);
    }
  }, [goldCardCount]);

  useEffect(() => {
    if (round > 5) {
      setIsGameOver(true);
    }
  }, [round]);

  useEffect(() => {
    alert('Good game!');
  }, [isGameOver]);

  function handlePlaceCard(nextCard) {
    if (isGameOver) {
      throw Error('Game already ended.');
    } else {
      setCard(nextCard);
    }
  }

  // ...
```

ржПржЗ ржХрзЛржбрзЗ ржжрзБржЯрж┐ рж╕ржорж╕рзНржпрж╛ рж░ржпрж╝рзЗржЫрзЗред

ржкрзНрж░ржержо рж╕ржорж╕рзНржпрж╛ рж╣рж▓рзЛ ржПржЯрж┐ ржЦрзБржмржЗ ржЕржХрж╛рж░рзНржпржХрж░; ржкрзНрж░рждрж┐ржЯрж┐ `set` ржХрж▓рзЗрж░ ржоржзрзНржпрзЗ ржХржорзНржкрзЛржирзЗржирзНржЯ (ржПржмржВ ржПрж░ ржЪрж╛ржЗрж▓рзНржб ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛ) ржкрзБржирж░рж╛рзЯ рж░рзЗржирзНржбрж╛рж░ рж╣рждрзЗ ржерж╛ржХрзЗред ржЙржкрж░рзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗ, рж╕ржмржЪрзЗржпрж╝рзЗ ржЦрж╛рж░рж╛ржк ржХрзНрж╖рзЗрждрзНрж░рзЗ (`setCard` тЖТ рж░рзЗржирзНржбрж╛рж░ тЖТ `setGoldCardCount` тЖТ рж░рзЗржирзНржбрж╛рж░ тЖТ `setRound` тЖТ рж░рзЗржирзНржбрж╛рж░ тЖТ `setIsGameOver` тЖТ рж░рзЗржирзНржбрж╛рж░) ржПржЗ ржЪрзЗржЗржиржЯрж┐ рждрж┐ржиржмрж╛рж░ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ржнрж╛ржмрзЗ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗ ржирж┐ржЪрзЗрж░ ржЯрзНрж░рзАржЯрж┐ред

ржПржЯрж┐ ржзрзАрж░ ржирж╛ рж╣рж▓рзЗржУ, ржХрзЛржбржЯрж┐ ржпржЦржи ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, рждржЦржи ржЖржкржирж┐ ржПржоржи ржкрж░рж┐рж╕рзНржерж┐рждрж┐рждрзЗ ржкржбрж╝ржмрзЗржи ржпрзЗржЦрж╛ржирзЗ ржПржЗ "ржЪрзЗржЗржи"ржЯрж┐ ржирждрзБржи ржЪрж╛рж╣рж┐ржжрж╛рж░ рж╕рж╛ржерзЗ рж╕рж╛ржоржЮрзНржЬрж╕рзНржпржкрзВрж░рзНржг ржиржпрж╝ред ржХрж▓рзНржкржирж╛ ржХрж░рзБржи ржЖржкржирж┐ ржЧрзЗржорзЗрж░ ржорзБржнрзЗрж░ ржЗрждрж┐рж╣рж╛рж╕рзЗрж░ ржоржзрзНржп ржжрж┐ржпрж╝рзЗ ржкрж░рзНржпрж╛ржпрж╝ржХрзНрж░ржорзЗ ржПржЧрж┐ржпрж╝рзЗ ржпрж╛ржУржпрж╝рж╛рж░ ржПржХржЯрж┐ ржЙржкрж╛ржпрж╝ ржпрзЛржЧ ржХрж░ржЫрзЗржиред ржЖржкржирж┐ ржПржЯрж┐ ржкрзНрж░рждрж┐ржЯрж┐ state ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржХрзЗ ржЕрждрзАрждрзЗрж░ ржорж╛ржирзЗ ржЖржкржбрзЗржЯ ржХрж░рзЗ ржХрж░ржмрзЗржиред рждржмрзЗ, ржЕрждрзАрждрзЗрж░ ржорж╛ржирзЗ `card` state рж╕рзЗржЯ ржХрж░рж▓рзЗ Effect ржЪрзЗржЗржиржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржмрзЗ ржПржмржВ ржЖржкржирж╛рж░ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд ржбрзЗржЯрж╛ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржмрзЗред ржП ржзрж░ржирзЗрж░ ржХрзЛржб ржкрзНрж░рж╛ржпрж╝рж╢ржЗ ржХржарзЛрж░ ржПржмржВ ржнржЩрзНржЧрзБрж░ рж╣ржпрж╝ред

ржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ, рж░рзЗржирзНржбрж╛рж░рж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ ржпрж╛ рж╕ржорзНржнржм рждрж╛ ржЧржгржирж╛ ржХрж░рж╛ржЗ ржнрж╛рж▓рзЛ ржПржмржВ event handler ржПрж░ ржоржзрзНржпрзЗ state рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рж╛ ржЙржЪрж┐рждред

```js {6-7,14-26}
function Game() {
  const [card, setCard] = useState(null);
  const [goldCardCount, setGoldCardCount] = useState(0);
  const [round, setRound] = useState(1);

  // тЬЕ Calculate what you can during rendering
  const isGameOver = round > 5;

  function handlePlaceCard(nextCard) {
    if (isGameOver) {
      throw Error('Game already ended.');
    }

    // тЬЕ Calculate all the next state in the event handler
    setCard(nextCard);
    if (nextCard.gold) {
      if (goldCardCount <= 3) {
        setGoldCardCount(goldCardCount + 1);
      } else {
        setGoldCardCount(0);
        setRound(round + 1);
        if (round === 5) {
          alert('Good game!');
        }
      }
    }
  }

  // ...
```

ржПржЯрж┐ ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржХрж╛рж░рзНржпржХрж░ред ржПржЫрж╛ржбрж╝рж╛ржУ, ржпржжрж┐ ржЖржкржирж┐ ржЧрзЗржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржжрзЗржЦрж╛рж░ ржПржХржЯрж┐ ржЙржкрж╛ржпрж╝ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзЗржи, рждрж╛рж╣рж▓рзЗ ржПржЦржи ржЖржкржирж┐ ржкрзНрж░рждрж┐ржЯрж┐ state ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржХрзЗ ржЕрждрзАрждрзЗрж░ ржХрзЛржирзЛ ржорзБржнрзЗ рж╕рзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржЬржирзНржп Trigger рж╣ржУржпрж╝рж╛ Effect ржЪрзЗржЗржиржЯрж┐ ржПржбрж╝рж╛рждрзЗ ржкрж╛рж░ржмрзЗржиред ржпржжрж┐ ржПржХрж╛ржзрж┐ржХ event handler-ржП рж▓ржЬрж┐ржХ ржкрзБржиржГржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржЖржкржирж┐ ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи [ржкрзНрж░рждрзНржпрж╛рж╣рж╛рж░ ржХрж░рзЗ](#sharing-logic-between-event-handlers) рж╕рзЗржЗ handler ржерзЗржХрзЗ ржХрж▓ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ event handler-ржПрж░ ржоржзрзНржпрзЗ, [state ржПржХржЯрж┐ snapshot-ржПрж░ ржорждрзЛ ржЖржЪрж░ржг ржХрж░рзЗред](/learn/state-as-a-snapshot) ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, `setRound(round + 1)` ржХрж▓ ржХрж░рж╛рж░ ржкрж░рзЗржУ, `round` ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ рж╕рзЗржЗ ржорж╛ржиржХрзЗ ржкрзНрж░рждрж┐ржлрж▓рж┐ржд ржХрж░ржмрзЗ ржпржЦржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзЛрждрж╛ржоржЯрж┐ ржХрзНрж▓рж┐ржХ ржХрж░рзЗржЫрж┐рж▓рзЗржиред ржпржжрж┐ ржЧржгржирж╛рж░ ржЬржирзНржп ржкрж░ржмрж░рзНрждрзА ржорж╛ржирзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржПржЯрж┐ ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓рж┐ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржи ржпрзЗржоржи `const nextRound = round + 1`ред

ржХрж┐ржЫрзБ ржХрзНрж╖рзЗрждрзНрж░рзЗ, event handler-ржП рж╕рж░рж╛рж╕рж░рж┐ ржкрж░ржмрж░рзНрждрзА state ржЧржгржирж╛ ржХрж░рж╛ рж╕ржорзНржнржм ржиржпрж╝ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржПржХржЯрж┐ ржлрж░рзНржорзЗрж░ ржХржерж╛ ржХрж▓рзНржкржирж╛ ржХрж░рзБржи ржпрзЗржЦрж╛ржирзЗ ржПржХрж╛ржзрж┐ржХ dropdown рж░ржпрж╝рзЗржЫрзЗ ржПржмржВ ржкрж░ржмрж░рзНрждрзА dropdown-ржПрж░ ржЕржкрж╢ржи ржЖржЧрзЗрж░ dropdown-ржПрж░ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржорж╛ржирзЗрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗред рждржЦржи, Effects-ржПрж░ ржПржХржЯрж┐ ржЪрзЗржЗржи ржЙржкржпрзБржХрзНржд, ржХрж╛рж░ржг ржЖржкржирж┐ ржирзЗржЯржУржпрж╝рж╛рж░рзНржХрзЗрж░ рж╕рж╛ржерзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░ржЫрзЗржиред

### ржПржкрзНрж▓рж┐ржХрзЗрж╢ржи ржЗржирж┐рж╢рж┐рзЯрзЗрж▓рж╛ржЗржЬ ржХрж░рж╛ {/*initializing-the-application*/}

ржЖржкржирж┐ рж╣ржпрж╝рждрзЛ ржЪрж╛ржЗржмрзЗржи ржпрзЗ ржХрж┐ржЫрзБ рж▓ржЬрж┐ржХ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЕрзНржпрж╛ржкржЯрж┐ рж▓рзЛржб рж╣рж▓рзЗ ржПржХржмрж╛рж░ржЗ рж░рж╛ржи рж╣рзЛржХред

ржЖржкржирж┐ ржПржЗ ржХрзЛржбржЯрж┐ ржЕрзНржпрж╛ржкрзЗрж░ рж╢рзАрж░рзНрж╖ рж╕рзНрждрж░рзЗрж░ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗ рж░рж╛ржЦрж╛рж░ ржХржерж╛ ржнрж╛ржмрждрзЗ ржкрж╛рж░рзЗржиред

```js {2-6}
function App() {
  // ЁЯФ┤ Avoid: Effects with logic that should only ever run once
  useEffect(() => {
    loadDataFromLocalStorage();
    checkAuthToken();
  }, []);
  // ...
}
```

рждржмрзЗ, ржЖржкржирж┐ ржжрзНрж░рзБржд ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗржи ржпрзЗ ржПржЯрж┐ [ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржжрзБржмрж╛рж░ рж░рж╛ржи ржХрж░рзЗ ](/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development)ред ржПржЯрж┐ рж╕ржорж╕рзНржпрж╛рж░ рж╕рзГрж╖рзНржЯрж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗтАФржпрзЗржоржи, рж╣ржпрж╝рждрзЛ ржПржЯрж┐ ржЕржерзЗржиржЯрж┐ржХрзЗрж╢ржи ржЯрзЛржХрзЗржиржХрзЗ ржЕржмрзИржз ржХрж░рзЗ ржлрзЗрж▓ржЫрзЗ ржХрж╛рж░ржг ржлрж╛ржВрж╢ржиржЯрж┐ ржжрзБржмрж╛рж░ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ рж╣ржпрж╝ржирж┐ред рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛ ржкрзБржирж░рж╛ржпрж╝ ржорж╛ржЙржирзНржЯ рж╣рждрзЗ ржкрзНрж░рждрж┐рж░рзЛржзрзА рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред ржПрж░ ржоржзрзНржпрзЗ ржЖржкржирж╛рж░ рж╢рзАрж░рзНрж╖ рж╕рзНрждрж░рзЗрж░ `App` ржХржорзНржкрзЛржирзЗржирзНржЯржУ ржЕржирзНрждрж░рзНржнрзБржХрзНрждред

ржпржжрж┐ржУ ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗ ржПржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ ржорж╛ржЙржирзНржЯ ржирж╛-ржУ рж╣рждрзЗ ржкрж╛рж░рзЗ, рж╕ржм ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржПржХржЗ ржирж┐ржпрж╝ржо ржЕржирзБрж╕рж░ржг ржХрж░рж▓рзЗ ржХрзЛржб рж╕рж░рж╛ржирзЛ ржПржмржВ ржкрзБржиржГржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╕рж╣ржЬ рж╣ржпрж╝ред ржпржжрж┐ ржХрзЛржирзЛ рж▓ржЬрж┐ржХ *ржЕрзНржпрж╛ржк рж▓рзЛржб ржкрзНрж░рждрж┐ ржПржХржмрж╛рж░* рж░рж╛ржи ржХрж░рждрзЗржЗ рж╣ржпрж╝ ржПржмржВ *ржХржорзНржкрзЛржирзЗржирзНржЯ ржорж╛ржЙржирзНржЯ ржкрзНрж░рждрж┐ ржПржХржмрж╛рж░* ржиржпрж╝, рждрж╛рж╣рж▓рзЗ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ рж╢рзАрж░рзНрж╖ рж╕рзНрждрж░рзЗрж░ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржпрзЛржЧ ржХрж░рзБржи ржпрзЗ ржПржЯрж┐ ржЗрждрзЛржоржзрзНржпрзЗржЗ ржПржХржмрж╛рж░ рж░рж╛ржи рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐ ржирж╛ред

```js {1,5-6,10}
let didInit = false;

function App() {
  useEffect(() => {
    if (!didInit) {
      didInit = true;
      // тЬЕ Only runs once per app load
      loadDataFromLocalStorage();
      checkAuthToken();
    }
  }, []);
  // ...
}
```

ржЖржкржирж┐ ржПржЯрж┐ ржоржбрж┐ржЙрж▓ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржирзЗрж░ рж╕ржоржпрж╝ ржПржмржВ ржЕрзНржпрж╛ржк рж░рзЗржирзНржбрж╛рж░ рж╣ржУржпрж╝рж╛рж░ ржЖржЧрзЗ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗржи:

```js {1,5}
if (typeof window !== 'undefined') { // Check if we're running in the browser.
   // тЬЕ Only runs once per app load
  checkAuthToken();
  loadDataFromLocalStorage();
}

function App() {
  // ...
}
```

рж╢рзАрж░рзНрж╖ рж╕рзНрждрж░рзЗрж░ ржХрзЛржб ржПржХржмрж╛рж░ рж░рж╛ржи ржХрж░рзЗ ржпржЦржи ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржЖржоржжрж╛ржирж┐ ржХрж░рж╛ рж╣ржпрж╝тАФржпржжрж┐ржУ ржПржЯрж┐ рж░рзЗржирзНржбрж╛рж░ ржирж╛-ржУ рж╣рждрзЗ ржкрж╛рж░рзЗред ржмрж┐ржнрж┐ржирзНржи ржХржорзНржкрзЛржирзЗржирзНржЯ ржЖржоржжрж╛ржирж┐ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржзрзАрж░ржЧрждрж┐рж░ ржмрж╛ ржмрж┐рж╕рзНржоржпрж╝ржХрж░ ржЖржЪрж░ржг ржПржбрж╝рж╛рждрзЗ, ржПржЗ ржкрзНржпрж╛ржЯрж╛рж░рзНржиржЯрж┐ ржЕрждрж┐рж░рж┐ржХрзНржд ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи ржирж╛ред ржЕрзНржпрж╛ржкрзЗрж░ рж╕рж╛рж░рзНржмржЬржирзАржи ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи рж▓ржЬрж┐ржХржХрзЗ `App.js` ржПрж░ ржорждрзЛ рж░рзБржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржоржбрж┐ржЙрж▓ржЧрзБрж▓рзЛрждрзЗ ржмрж╛ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ ржПржирзНржЯрзНрж░рж┐ ржкржпрж╝рзЗржирзНржЯрзЗ рж░рж╛ржЦрзБржиред

### ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждржи рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирж╛ржирзЛ {/*notifying-parent-components-about-state-changes*/}

ржзрж░рж┐, ржЖржкржирж┐ ржПржХржЯрж┐ `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯ рж▓рж┐ржЦржЫрзЗржи ржпрж╛рж░ ржПржХржЯрж┐ ржЕржнрзНржпржирзНрждрж░рзАржг `isOn` рж╕рзНржЯрзЗржЯ ржЖржЫрзЗ ржпрж╛ `true` ржмрж╛ `false` рж╣рждрзЗ ржкрж╛рж░рзЗред ржПржЯрж┐ ржЯржЧрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржХрж┐ржЫрзБ ржнрж┐ржирзНржи ржЙржкрж╛ржпрж╝ ржЖржЫрзЗ (ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржмрж╛ ржбрзНрж░рзНржпрж╛ржЧ ржХрж░рзЗ)ред ржЖржкржирж┐ ржЪрж╛ржи ржпрзЗ ржпржЦржиржЗ `Toggle` ржПрж░ ржЕржнрзНржпржирзНрждрж░рзАржг рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржЬрж╛ржирж╛ржирзЛ рж╣рзЛржХ, рждрж╛ржЗ ржЖржкржирж┐ ржПржХржЯрж┐ `onChange` ржЗржнрзЗржирзНржЯ ржкрзНрж░ржХрж╛рж╢ ржХрж░рзЗржи ржПржмржВ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯ ржерзЗржХрзЗ ржПржЯрж┐ ржХрж▓ ржХрж░рзЗржи:

```js {4-7}
function Toggle({ onChange }) {
  const [isOn, setIsOn] = useState(false);

  // ЁЯФ┤ Avoid: The onChange handler runs too late
  useEffect(() => {
    onChange(isOn);
  }, [isOn, onChange])

  function handleClick() {
    setIsOn(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      setIsOn(true);
    } else {
      setIsOn(false);
    }
  }

  // ...
}
```

ржпрзЗржоржи ржЖржЧрзЗ ржмрж▓рж╛ рж╣ржпрж╝рзЗржЫрж┐рж▓, ржПржЯрж┐ ржЖржжрж░рзНрж╢ ржиржпрж╝ред `Toggle` ржкрзНрж░ржержорзЗ рждрж╛рж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗ, ржПржмржВ рждрж╛рж░ржкрж░ React рж╕рзНржХрзНрж░рзАржиржЯрж┐ ржЖржкржбрзЗржЯ ржХрж░рзЗред ржПрж░ ржкрж░рзЗ React ржЗржлрзЗржХрзНржЯржЯрж┐ рж░рж╛ржи ржХрж░рзЗ, ржпрж╛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ ржкрзНрж░рж╛ржкрзНржд `onChange` ржлрж╛ржВрж╢ржиржЯрж┐ ржХрж▓ ржХрж░рзЗред ржПржЦржи ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ рждрж╛рж░ ржирж┐ржЬрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░ржмрзЗ, ржпрж╛ ржПржХржЯрж┐ ржирждрзБржи рж░рзЗржирзНржбрж╛рж░ ржкрж╛рж╕ рж╢рзБрж░рзБ ржХрж░ржмрзЗред рж╕ржмржХрж┐ржЫрзБ ржПржХржХ ржкрж╛рж╕рзЗ ржХрж░рж╛ ржЖрж░ржУ ржнрж╛рж▓рзЛ рж╣ржмрзЗред

ржЗржлрзЗржХрзНржЯржЯрж┐ ржорзБржЫрзЗ ржжрж┐ржи ржПржмржВ ржкрж░рж┐ржмрж░рзНрждрзЗ ржПржХржЗ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗрж░ ржоржзрзНржпрзЗ *ржжрзБржЗржЯрж┐* ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзБржи:

```js {5-7,11,16,18}
function Toggle({ onChange }) {
  const [isOn, setIsOn] = useState(false);

  function updateToggle(nextIsOn) {
    // тЬЕ Good: Perform all updates during the event that caused them
    setIsOn(nextIsOn);
    onChange(nextIsOn);
  }

  function handleClick() {
    updateToggle(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      updateToggle(true);
    } else {
      updateToggle(false);
    }
  }

  // ...
}
```

ржПржЗ ржкржжрзНржзрждрж┐рж░ ржорж╛ржзрзНржпржорзЗ, `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржмржВ ржПрж░ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржЙржнржпрж╝ржЗ ржЗржнрзЗржирзНржЯрзЗрж░ рж╕ржоржпрж╝ рждрж╛ржжрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗред React ржмрж┐ржнрж┐ржирзНржи ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ [ржмрзНржпрж╛ржЪ ржЖржкржбрзЗржЯ](/learn/queueing-a-series-of-state-updates) ржХрж░рзЗ, рждрж╛ржЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ рж░рзЗржирзНржбрж╛рж░ ржкрж╛рж╕ рж╣ржмрзЗред

ржЖржкржирж┐ рж╕ржорзНржнржмржд рж╕ржорзНржкрзВрж░рзНржг рж╕рзНржЯрзЗржЯржЯрж┐ ржорзБржЫрзЗржУ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ ржкрж░рж┐ржмрж░рзНрждрзЗ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ `isOn` ржЧрзНрж░рж╣ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:

```js {1,2}
// тЬЕ Also good: the component is fully controlled by its parent
function Toggle({ isOn, onChange }) {
  function handleClick() {
    onChange(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      onChange(true);
    } else {
      onChange(false);
    }
  }

  // ...
}
```

["рж╕рзНржЯрзЗржЯ ржЙржкрж░рзЗ рждрзЛрж▓рж╛"](/learn/sharing-state-between-components) ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ рж╕ржорзНржкрзВрж░рзНржгрж░рзВржкрзЗ `Toggle` ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗржпрж╝ ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗрж░ ржирж┐ржЬрж╕рзНржм рж╕рзНржЯрзЗржЯ ржЯржЧрж▓ ржХрж░рзЗред ржПрж░ ржорж╛ржирзЗ рж╣рж▓рзЛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржЖрж░ржУ ржмрзЗрж╢рж┐ рж▓ржЬрж┐ржХ ржерж╛ржХрждрзЗ рж╣ржмрзЗ, рждржмрзЗ ржорзЛржЯ рж╕рзНржЯрзЗржЯ ржХржо ржерж╛ржХржмрзЗ ржпрж╛ ржирж┐ржпрж╝рзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рждрзЗ рж╣ржмрзЗред ржпржЦржиржЗ ржЖржкржирж┐ ржжрзБржЯрж┐ ржнрж┐ржирзНржи рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржХрзЗ рж╕ржоржирзНржмржпрж╝ ржХрж░рждрзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗржи, рждржЦржи рж╕рзНржЯрзЗржЯ ржЙржкрж░рзЗ рждрзЛрж▓рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи!

### ржкрзЗрж░ржирзНржЯ ржП ржбрж╛ржЯрж╛ ржкрж╛рж╕ ржХрж░рж╛ {/*passing-data-to-the-parent*/}

ржПржЗ `Child` ржХржорзНржкрзЛржирзЗржирзНржЯ ржХрж┐ржЫрзБ ржбрзЗржЯрж╛ Fetch ржХрж░рзЗ ржПржмржВ рждрж╛рж░ржкрж░ ржПржЯрж┐ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ `Parent` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржкрж╛ржарж╛ржпрж╝:

```js {9-14}
function Parent() {
  const [data, setData] = useState(null);
  // ...
  return <Child onFetched={setData} />;
}

function Child({ onFetched }) {
  const data = useSomeAPI();
  // ЁЯФ┤ Avoid: Passing data to the parent in an Effect
  useEffect(() => {
    if (data) {
      onFetched(data);
    }
  }, [onFetched, data]);
  // ...
}
```

React-ржП, ржбрзЗржЯрж╛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ рждрж╛ржжрзЗрж░ рж╕ржирзНрждрж╛ржирзЗрж░ ржжрж┐ржХрзЗ ржкрзНрж░ржмрж╛рж╣рж┐ржд рж╣ржпрж╝ред ржпржЦржи ржЖржкржирж┐ рж╕рзНржХрзНрж░рзАржирзЗ ржХрж┐ржЫрзБ ржнрзБрж▓ ржжрзЗржЦрждрзЗ ржкрж╛ржи, ржЖржкржирж┐ ржХрзЛржи рждржерзНржп ржХрзЛржерж╛ ржерзЗржХрзЗ ржПрж╕рзЗржЫрзЗ рждрж╛ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржХржорзНржкрзЛржирзЗржирзНржЯ ржЪрзЗржЗржи ржЙржкрж░рзЗ ржЙржарждрзЗ ржкрж╛рж░рзЗржи ржпрждржХрзНрж╖ржг ржирж╛ ржЖржкржирж┐ ржЦрзБржБржЬрзЗ ржкрж╛ржи ржХрзЛржи ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржнрзБрж▓ ржкрзНрж░ржкрзНрж╕ ржкрж╛рж╕ ржХрж░ржЫрзЗ ржмрж╛ ржнрзБрж▓ рж╕рзНржЯрзЗржЯ ржЖржЫрзЗред ржпржЦржи рж╕ржирзНрждрж╛ржирзЗрж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛ рждрж╛ржжрзЗрж░ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЗржлрзЗржХрзНржЯрзЗ ржЖржкржбрзЗржЯ ржХрж░рзЗ, рждржЦржи ржбрзЗржЯрж╛рж░ ржкрзНрж░ржмрж╛рж╣ ржЕржирзБрж╕рж░ржг ржХрж░рж╛ ржЦрзБржм ржХржарж┐ржи рж╣ржпрж╝рзЗ ржкржбрж╝рзЗред ржпрзЗрж╣рзЗрждрзБ рж╕ржирзНрждрж╛ржирзЗрж░ ржПржмржВ ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗрж░ ржЙржнржпрж╝рзЗрж░ржЗ ржПржХржЗ ржбрзЗржЯрж╛рж░ ржкрзНрж░ржпрж╝рзЛржЬржи, рждрж╛ржЗ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ рж╕рзЗржЗ ржбрзЗржЯрж╛ Fetch ржХрж░рждрзЗ ржжрж┐ржи ржПржмржВ *рж╕ржирзНрждрж╛ржирзЗрж░ ржХрж╛ржЫрзЗ* ржкрж╛рж╕ ржХрж░рзБржи:

```js {4-5}
function Parent() {
  const data = useSomeAPI();
  // ...
  // тЬЕ Good: Passing data down to the child
  return <Child data={data} />;
}

function Child({ data }) {
  // ...
}
```

ржПржЯрж┐ рж╕рж╣ржЬ ржПржмржВ ржбрзЗржЯрж╛рж░ ржкрзНрж░ржмрж╛рж╣ржХрзЗ ржкрзВрж░рзНржмрж╛ржирзБржорж╛ржиржпрзЛржЧрзНржп рж░рж╛ржЦрзЗ: ржбрзЗржЯрж╛ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржерзЗржХрзЗ рж╕ржирзНрждрж╛ржирзЗрж░ ржжрж┐ржХрзЗ ржкрзНрж░ржмрж╛рж╣рж┐ржд рж╣ржпрж╝ред

### ржПржХрзНрж╕ржЯрж╛рж░рзНржирж╛рж▓ рж╕рзНржЯрзЛрж░рзЗрж░ ржЬржирзНржп рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рж╛ {/*subscribing-to-an-external-store*/}

ржХржЦржиржУ ржХржЦржиржУ, ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ React рж╕рзНржЯрзЗржЯрзЗрж░ ржмрж╛ржЗрж░рзЗрж░ ржХрж┐ржЫрзБ ржбрзЗржЯрж╛рж░ ржЬржирзНржп рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рждрзЗ рж╣рждрзЗ ржкрж╛рж░рзЗред ржПржЗ ржбрзЗржЯрж╛ ржПржХржЯрж┐ рждрзГрждрзАржпрж╝-ржкржХрзНрж╖ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржмрж╛ ржПржХржЯрж┐ ржмрж┐рж▓рзНржЯ-ржЗржи ржмрзНрж░рж╛ржЙржЬрж╛рж░ API ржерзЗржХрзЗ ржЖрж╕рждрзЗ ржкрж╛рж░рзЗред ржпрзЗрж╣рзЗрждрзБ ржПржЗ ржбрзЗржЯрж╛ React ржПрж░ ржЬрзНржЮрж╛ржирзЗрж░ ржмрж╛ржЗрж░рзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗ, рждрж╛ржЗ ржЖржкржирж╛ржХрзЗ рж╣рж╛рждрзЗ рж╣рж╛рждрзЗ ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ ржПрж░ рж╕рж╛ржерзЗ рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рждрзЗ рж╣ржмрзЗред ржПржЯрж┐ ржкрзНрж░рж╛ржпрж╝ржЗ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржХрж░рж╛ рж╣ржпрж╝, ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк:

```js {2-17}
function useOnlineStatus() {
  // Not ideal: Manual store subscription in an Effect
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    function updateState() {
      setIsOnline(navigator.onLine);
    }

    updateState();

    window.addEventListener('online', updateState);
    window.addEventListener('offline', updateState);
    return () => {
      window.removeEventListener('online', updateState);
      window.removeEventListener('offline', updateState);
    };
  }, []);
  return isOnline;
}

function ChatIndicator() {
  const isOnline = useOnlineStatus();
  // ...
}
```

ржПржЦрж╛ржирзЗ, ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржПржХржЯрж┐ ржПржХрзНрж╕ржЯрж╛рж░рзНржирж╛рж▓ ржбрзЗржЯрж╛ рж╕рзНржЯрзЛрж░рзЗрж░ ржЬржирзНржп рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рзЗ (ржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ, ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗрж░ `navigator.onLine` API)ред ржпрзЗрж╣рзЗрждрзБ ржПржЗ API рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржмрж┐ржжрзНржпржорж╛ржи ржирзЗржЗ (ржПржЯрж┐ ржкрзНрж░рж╛ржержорж┐ржХ HTML-ржПрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржпрж╝ ржирж╛), рж╢рзБрж░рзБрждрзЗ рж╕рзНржЯрзЗржЯ `true` рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред ржпржЦржиржЗ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ рж╕рзЗржЗ ржбрзЗржЯрж╛ рж╕рзНржЯрзЛрж░рзЗрж░ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржХржорзНржкрзЛржирзЗржирзНржЯ рждрж╛рж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗред

ржпржжрж┐ржУ ржПржЯрж┐ ржХрж░рж╛рж░ ржЬржирзНржп ржЗржлрзЗржХрзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╕рж╛ржзрж╛рж░ржг, React-ржП ржПржХржЯрж┐ ржмрж┐рж╢рзЗрж╖ржнрж╛ржмрзЗ ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ рж╣рзБржХ ржЖржЫрзЗ ржпрж╛ ржПржХржЯрж┐ ржПржХрзНрж╕ржЯрж╛рж░рзНржирж╛рж▓ рж╕рзНржЯрзЛрж░рзЗрж░ ржЬржирзНржп рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝, ржпрж╛ ржЖрж░ржУ ржкржЫржирзНржжрж╕ржЗред ржЗржлрзЗржХрзНржЯржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржи ржПржмржВ [`useSyncExternalStore`](/reference/react/useSyncExternalStore) ржХрж▓рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржи:

```js {11-16}
function subscribe(callback) {
  window.addEventListener('online', callback);
  window.addEventListener('offline', callback);
  return () => {
    window.removeEventListener('online', callback);
    window.removeEventListener('offline', callback);
  };
}

function useOnlineStatus() {
  // тЬЕ Good: Subscribing to an external store with a built-in Hook
  return useSyncExternalStore(
    subscribe, // React won't resubscribe for as long as you pass the same function
    () => navigator.onLine, // How to get the value on the client
    () => true // How to get the value on the server
  );
}

function ChatIndicator() {
  const isOnline = useOnlineStatus();
  // ...
}
```

ржПржЗ ржкржжрзНржзрждрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржорж┐ржЙржЯрзЗржмрж▓ ржбрзЗржЯрж╛ржХрзЗ React рж╕рзНржЯрзЗржЯрзЗрж░ рж╕рж╛ржерзЗ ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓рж┐ рж╕рж┐ржЩрзНржХ ржХрж░рж╛рж░ ржЪрзЗржпрж╝рзЗ ржХржо рждрзНрж░рзБржЯрж┐ржкрзВрж░рзНржгред рж╕рж╛ржзрж╛рж░ржгржд, ржЖржкржирж┐ ржЙржкрж░рзЗрж░ ржорждрзЛ ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо рж╣рзБржХ рж▓рж┐ржЦржмрзЗржи ржпрзЗржоржи useOnlineStatus() ржпрж╛рждрзЗ ржЖржкржирж╛ржХрзЗ ржкрзГржержХ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржПржЗ ржХрзЛржбржЯрж┐ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ ржХрж░рждрзЗ ржирж╛ рж╣ржпрж╝ред [ржПржХрзНрж╕ржЯрж╛рж░рзНржирж╛рж▓ рж╕рзНржЯрзЛрж░ржЧрзБрж▓рзЛрж░ ржЬржирзНржп React ржХржорзНржкрзЛржирзЗржирзНржЯ ржерзЗржХрзЗ рж╕рж╛ржмрж╕рзНржХрзНрж░рж╛ржЗржм ржХрж░рж╛рж░ ржмрж┐рж╖ржпрж╝рзЗ ржЖрж░ржУ ржкржбрж╝рзБржиред](/reference/react/useSyncExternalStore)

### Fetching data {/*fetching-data*/}

ржЕржирзЗржХ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржи ржбрзЗржЯрж╛ Fetch ржХрж░рж╛рж░ ржЬржирзНржп ржЗржлрзЗржХрзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред ржПржХржЯрж┐ ржбрзЗржЯрж╛ Fetch ржХрж░рж╛рж░ ржЗржлрзЗржХрзНржЯ ржПржЗржнрж╛ржмрзЗ рж▓рзЗржЦрж╛ ржЦрзБржм рж╕рж╛ржзрж╛рж░ржг:

```js {5-10}
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);

  useEffect(() => {
    // ЁЯФ┤ Avoid: Fetching without cleanup logic
    fetchResults(query, page).then(json => {
      setResults(json);
    });
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
```

ржЖржкржирж╛ржХрзЗ ржПржЗ ржлрзЗржЪржЯрж┐ ржПржХржЯрж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░ ржХрж░рждрзЗ *рж╣ржмрзЗржирж╛*ред

ржПржЯрж┐ ржкрзНрж░ржержо ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рзЛрж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржмрзИржкрж░рзАрждрзНржп ржоржирзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ ржпрзЗржЦрж╛ржирзЗ ржЖржкржирж╛ржХрзЗ рж▓ржЬрж┐ржХржЯрж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ржЧрзБрж▓рж┐рждрзЗ рж░рж╛ржЦрждрзЗ рж╣ржпрж╝рзЗржЫрзЗ! рждржмрзЗ, ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ ржПржЯрж┐ *ржЯрж╛ржЗржкрж┐ржВ ржЗржнрзЗржирзНржЯ* ржиржпрж╝ ржпрж╛ Fetch ржХрж░рж╛рж░ ржкрзНрж░ржзрж╛ржи ржХрж╛рж░ржгред рж╕рж╛рж░рзНржЪ ржЗржиржкрзБржЯржЧрзБрж▓рж┐ ржкрзНрж░рж╛ржпрж╝рж╢ржЗ URL ржерзЗржХрзЗ ржкрзВрж░рзНржмржирж┐рж░рзНржзрж╛рж░рж┐ржд рж╣ржпрж╝, ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЗржиржкрзБржЯржЯрж┐ рж╕рзНржкрж░рзНрж╢ ржирж╛ ржХрж░рзЗржЗ ржмрзНржпрж╛ржХ ржПржмржВ ржлрж░рзЛржпрж╝рж╛рж░рзНржбрзЗ ржирзЗржнрж┐ржЧрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗред

`page` ржПржмржВ `query` ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕ржЫрзЗ рждрж╛ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржиржпрж╝ред ржпржЦржи ржПржЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржжрзГрж╢рзНржпржорж╛ржи ржерж╛ржХрзЗ, ржЖржкржирж┐ `results` ржХрзЗ ржмрж░рзНрждржорж╛ржи `page` ржПржмржВ `query` ржПрж░ ржЬржирзНржп ржирзЗржЯржУржпрж╝рж╛рж░рзНржХрзЗрж░ ржбрзЗржЯрж╛рж░ рж╕рж╛ржерзЗ [рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ](/learn/synchronizing-with-effects) рж░рж╛ржЦрждрзЗ ржЪрж╛ржиред ржП ржХрж╛рж░ржгрзЗржЗ ржПржЯрж┐ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯред

рждржмрзЗ, ржЙржкрж░рзЗрж░ ржХрзЛржбрзЗ ржПржХржЯрж┐ ржмрж╛ржЧ ржЖржЫрзЗред ржХрж▓рзНржкржирж╛ ржХрж░рзБржи ржЖржкржирж┐ ржжрзНрж░рзБржд `"hello"` ржЯрж╛ржЗржк ржХрж░ржЫрзЗржиред рждрж╛рж░ржкрж░ `query` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржмрзЗ `"h"` ржерзЗржХрзЗ `"he"`, `"hel"`, `"hell"` ржПржмржВ `"hello"`-рждрзЗред ржПржЯрж┐ ржЖрж▓рж╛ржжрж╛ ржлрзЗржЪржЧрзБрж▓рж┐ рж╢рзБрж░рзБ ржХрж░ржмрзЗ, ржХрж┐ржирзНрждрзБ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржЧрзБрж▓рж┐рж░ ржХрзЛржи ржЕрж░рзНржбрж╛рж░рзЗ ржЖрж╕ржмрзЗ рждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржиржпрж╝ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, `"hell"` ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ ржЖрж╕рждрзЗ ржкрж╛рж░рзЗ *ржПрж░ржкрж░* `"hello"` ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛рж░ред ржпрзЗрж╣рзЗрждрзБ ржПржЯрж┐ рж╢рзЗрж╖ржмрж╛рж░ `setResults()` ржХрж▓ ржХрж░ржмрзЗ, ржЖржкржирж┐ ржнрзБрж▓ рж╕рж╛рж░рзНржЪ ржлрж▓рж╛ржлрж▓ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░ржмрзЗржиред ржПржХрзЗ ржмрж▓рж╛ рж╣ржпрж╝ ["рж░рзЗрж╕ ржХржирзНржбрж┐рж╢ржи"](https://en.wikipedia.org/wiki/Race_condition): ржжрзБржЯрж┐ ржнрж┐ржирзНржи ржЕржирзБрж░рзЛржз "рж░рзЗрж╕" ржХрж░рзЗржЫрзЗ ржПржХрзЗ ржЕржкрж░рзЗрж░ ржмрж┐рж░рзБржжрзНржзрзЗ ржПржмржВ ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржЕрж░рзНржбрж╛рж░рзЗрж░ ржЪрзЗржпрж╝рзЗ ржнрж┐ржирзНржи ржЕрж░рзНржбрж╛рж░рзЗ ржПрж╕рзЗржЫрзЗред

**рж░рзЗрж╕ ржХржирзНржбрж┐рж╢ржиржЯрж┐ ржарж┐ржХ ржХрж░рждрзЗ, ржЖржкржирж╛ржХрзЗ [ржПржХржЯрж┐ ржХрзНрж▓рж┐ржиржЖржк ржлрж╛ржВрж╢ржи](/learn/synchronizing-with-effects#fetching-data) ржпрзЛржЧ ржХрж░рждрзЗ рж╣ржмрзЗ ржпрж╛рждрзЗ ржкрзБрж░рж╛ржирзЛ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржЧрзБрж▓рж┐ ржЙржкрзЗржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржпрж╝:**

```js {5,7,9,11-13}
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);
  useEffect(() => {
    let ignore = false;
    fetchResults(query, page).then(json => {
      if (!ignore) {
        setResults(json);
      }
    });
    return () => {
      ignore = true;
    };
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
```

ржПржЯрж┐ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ ржпрзЗ ржпржЦржи ржЖржкржирж╛рж░ ржЗржлрзЗржХрзНржЯ ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рзЗ, рждржЦржи рж╢рзЗрж╖ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржХрж░рж╛ рж░рзЗрж╕ржкржирзНрж╕ ржЫрж╛ржбрж╝рж╛ рж╕ржм рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЙржкрзЗржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржмрзЗред

ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржирзЗрж░ рж╕рж╛ржерзЗ рж░рзЗрж╕ ржХржирзНржбрж┐рж╢ржиржЧрзБрж▓рж┐ ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рж╛ ржПржХржорж╛рждрзНрж░ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржиржпрж╝ред ржЖржкржирж┐ рж░рзЗрж╕ржкржирзНрж╕ржЧрзБрж▓рж┐рж░ ржХрзНржпрж╛рж╢рж┐ржВ рж╕ржорзНржкрж░рзНржХрзЗржУ ржЪрж┐ржирзНрждрж╛ ржХрж░рждрзЗ ржЪрж╛ржЗрждрзЗ ржкрж╛рж░рзЗржи (ржпрж╛рждрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзНржпрж╛ржХ ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ ржЖржЧрзЗрж░ рж╕рзНржХрзНрж░рж┐ржиржЯрж┐ рждрж╛рждрзНржХрзНрж╖ржгрж┐ржХржнрж╛ржмрзЗ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗ), рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржбрзЗржЯрж╛ ржХрзАржнрж╛ржмрзЗ ржлрзЗржЪ ржХрж░рждрзЗ рж╣ржмрзЗ (ржпрж╛рждрзЗ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рж╛рж░рзНржнрж╛рж░-рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛ HTML-ржП ржлрзЗржЪ ржХрж░рж╛ ржХржиржЯрзЗржирзНржЯ ржерж╛ржХрзЗ рж╕рзНржкрж┐ржирж╛рж░рзЗрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ), ржПржмржВ ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржУржпрж╝рж╛ржЯрж╛рж░ржлрж▓ржЧрзБрж▓рж┐ ржХрзАржнрж╛ржмрзЗ ржПржбрж╝рж╛ржирзЛ ржпрж╛ржпрж╝ (ржпрж╛рждрзЗ ржПржХржЯрж┐ рж╕ржирзНрждрж╛ржи ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗрж░ ржЬржирзНржп ржЕржкрзЗржХрзНрж╖рж╛ ржирж╛ ржХрж░рзЗ)ред

**ржПржЗ рж╕ржорж╕рзНржпрж╛ржЧрзБрж▓рж┐ ржпрзЗржХрзЛржи UI рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐рждрзЗ ржкрзНрж░ржпрзЛржЬрзНржп, рж╢рзБржзрзБ React ржирзЯред ржПржЧрзБрж▓рж┐ рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ рж╕рж╣ржЬ ржиржпрж╝, ржПржЬржирзНржп ржЖржзрзБржирж┐ржХ [ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХржЧрзБрж▓рж┐](/learn/start-a-new-react-project#production-grade-react-frameworks) ржЗржлрзЗржХрзНржЯрзЗ ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рж╛рж░ ржЪрзЗржпрж╝рзЗ ржЖрж░ржУ ржХрж╛рж░рзНржпржХрж░ ржмрж┐рж▓рзНржЯ-ржЗржи ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ ржпрж╛ржирзНрждрзНрж░рж┐ржХ рж╕рж░ржмрж░рж╛рж╣ ржХрж░рзЗред**

ржпржжрж┐ ржЖржкржирж┐ ржПржХржЯрж┐ ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХ ржмрзНржпржмрж╣рж╛рж░ ржирж╛ ржХрж░рзЗржи (ржПржмржВ ржЖржкржирж╛рж░ ржирж┐ржЬрж╕рзНржм рждрзИрж░рж┐ ржХрж░рждрзЗ ржирж╛ ржЪрж╛ржи) рждржмрзЗ ржЗржлрзЗржХрзНржЯ ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВржХрзЗ ржЖрж░ржУ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрж╛ржирзНржзржм ржХрж░рждрзЗ ржЪрж╛ржи, рждржмрзЗ ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржорждрзЛ ржЖржкржирж╛рж░ ржлрзЗржЪрж┐ржВ рж▓ржЬрж┐ржХржЯрж┐ржХрзЗ ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо рж╣рзБржХрзЗрж░ ржоржзрзНржпрзЗ ржирж┐рж╖рзНржХрж╛рж╢ржи ржХрж░рждрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рзБржи:

```js {4}
function SearchResults({ query }) {
  const [page, setPage] = useState(1);
  const params = new URLSearchParams({ query, page });
  const results = useData(`/api/search?${params}`);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}

function useData(url) {
  const [data, setData] = useState(null);
  useEffect(() => {
    let ignore = false;
    fetch(url)
      .then(response => response.json())
      .then(json => {
        if (!ignore) {
          setData(json);
        }
      });
    return () => {
      ignore = true;
    };
  }, [url]);
  return data;
}
```

ржЖржкржирж┐ рж╕ржорзНржнржмржд рждрзНрж░рзБржЯрж┐ ржкрж░рж┐ржЪрж╛рж▓ржирж╛рж░ ржЬржирзНржп ржХрж┐ржЫрзБ рж▓ржЬрж┐ржХ ржпрзБржХрзНржд ржХрж░рждрзЗ ржЪрж╛ржи ржПржмржВ ржХржирзНржЯрзЗржирзНржЯ рж▓рзЛржб рж╣ржЪрзНржЫрзЗ ржХрж┐ржирж╛ рждрж╛ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рждрзЗ ржЪрж╛ржиред ржЖржкржирж┐ ржирж┐ржЬрзЗржЗ ржПржоржи ржПржХржЯрж┐ рж╣рзБржХ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржЕржержмрж╛ React ржЗржХрзЛрж╕рж┐рж╕рзНржЯрзЗржорзЗ ржЗрждрж┐ржоржзрзНржпрзЗржЗ ржЙржкрж▓ржмрзНржз ржЕржирзЗржХ рж╕ржорж╛ржзрж╛ржирзЗрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред **ржпржжрж┐ржУ ржПржЯрж┐ ржПржХрж╛ ржПржХржЯрж┐ ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХрзЗрж░ ржмрж┐рж▓рзНржЯ-ржЗржи ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ ржпрж╛ржирзНрждрзНрж░рж┐ржХрзЗрж░ ржЪрзЗржпрж╝рзЗ рждрждржЯрж╛ ржХрж╛рж░рзНржпржХрж░ рж╣ржмрзЗ ржирж╛, ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо рж╣рзБржХрзЗ ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ рж▓ржЬрж┐ржХржЯрж┐ рж╕рзНржерж╛ржирж╛ржирзНрждрж░ ржХрж░рж╛ ржкрж░ржмрж░рзНрждрзАрждрзЗ ржПржХржЯрж┐ ржХрж╛рж░рзНржпржХрж░ ржбрзЗржЯрж╛ ржлрзЗржЪрж┐ржВ ржХрзМрж╢рж▓ ржЧрзНрж░рж╣ржг ржХрж░рж╛ рж╕рж╣ржЬ ржХрж░ржмрзЗред**

рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржпржЦржиржЗ ржЖржкржирж╛ржХрзЗ ржЗржлрзЗржХрзНржЯ рж▓рж┐ржЦрждрзЗ ржмрж╛ржзрзНржп рж╣рждрзЗ рж╣ржпрж╝, рждржЦржи ржиржЬрж░ рж░рж╛ржЦрзБржи ржХржЦржи ржЖржкржирж┐ ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо рж╣рзБржХрзЗ ржПржХржЯрж┐ ржХрж╛рж░рзНржпржХрж░рзА ржЕржВрж╢ ржирж┐рж╖рзНржХрж╛рж╢ржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржХржЯрж┐ ржЖрж░ржУ ржШрзЛрж╖ржгрж╛ржорзВрж▓ржХ ржПржмржВ ржЙржжрзНржжрзЗрж╢рзНржп-ржирж┐рж░рзНржорж┐ржд API ржПрж░ рж╕рж╛ржерзЗ ржпрзЗржоржи ржЙржкрж░рзЗ `useData`ред ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рж┐рждрзЗ ржпржд ржХржо ржХрж╛ржБржЪрж╛ `useEffect` ржХрж▓ ржерж╛ржХржмрзЗ, ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржиржЯрж┐ ржмржЬрж╛ржпрж╝ рж░рж╛ржЦрж╛ рждрждржЯрж╛ржЗ рж╕рж╣ржЬ рж╣ржмрзЗред

<Recap>

- ржпржжрж┐ ржЖржкржирж┐ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржХрж┐ржЫрзБ рж╣рж┐рж╕рж╛ржм ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ ржЖржкржирж╛ржХрзЗ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред
- ржмрзНржпржпрж╝ржмрж╣рзБрж▓ ржЧржгржирж╛ ржХрзНржпрж╛рж╢ ржХрж░рж╛рж░ ржЬржирзНржп, `useEffect` ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ `useMemo` ржпрзБржХрзНржд ржХрж░рзБржиред
- ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг ржХржорзНржкрзЛржирзЗржирзНржЯ ржЧрж╛ржЫрзЗрж░ рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рждрзЗ, ржПрж░ ржЬржирзНржп ржПржХржЯрж┐ ржнрж┐ржирзНржи `key` ржкрж╛рж╕ ржХрж░рзБржиред
- ржПржХржЯрж┐ ржкрзНрж░рзЛржк ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ рж╣рж┐рж╕рж╛ржмрзЗ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕рзНржЯрзЗржЯрзЗрж░ ржЕржВрж╢ рж░рж┐рж╕рзЗржЯ ржХрж░рждрзЗ, ржПржЯрж┐ рж░рзЗржирзНржбрж╛рж░рж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ рж╕рзЗржЯ ржХрж░рзБржиред
- ржХрзЛржб ржпрж╛ ржПржХржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржУржпрж╝рж╛рж░ ржХрж╛рж░ржгрзЗ ржЪрж╛рж▓рж┐ржд рж╣ржпрж╝ рждрж╛ ржЗржлрзЗржХрзНржЯрзЗ ржерж╛ржХрж╛ ржЙржЪрж┐ржд, ржмрж╛ржХрж┐ ржЕржВрж╢ ржЗржнрзЗржирзНржЯрзЗ ржерж╛ржХрж╛ ржЙржЪрж┐рждред
- ржпржжрж┐ ржЖржкржирж╛ржХрзЗ ржХржпрж╝рзЗржХржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ рж╣ржпрж╝, рждржмрзЗ ржПржЯрж┐ ржПржХржЯрж┐ ржПржХржХ ржЗржнрзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ ржХрж░рж╛ ржнрж╛рж▓рзЛред
- ржпржЦржиржЗ ржЖржкржирж┐ ржмрж┐ржнрж┐ржирзНржи ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЧрзБрж▓рж┐ржХрзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рждрзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗржи, рждрж╛рж╣рж▓рзЗ рж╕рзНржЯрзЗржЯржХрзЗ ржЖржк ржХрж░рждрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рзБржиред
- ржЖржкржирж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ рж░рзЗрж╕ ржХржирзНржбрж┐рж╢ржи ржПржбрж╝рж╛ржирзЛрж░ ржЬржирзНржп ржХрзНрж▓рж┐ржиржЖржк ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рждрзЗ рж╣ржмрзЗред

</Recap>

<Challenges>

#### ржПржлрзЗржХрзНржЯ ржЫрж╛рзЬрж╛ ржбрж╛ржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░рзНржо {/*transform-data-without-effects*/}

ржирж┐ржЪрзЗрж░ `TodoList` ржПржХржЯрж┐ ржЯрзЛржбрзЛрж░ рждрж╛рж▓рж┐ржХрж╛ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рзЗред ржпржЦржи "рж╢рзБржзрзБржорж╛рждрзНрж░ рж╕ржХрзНрж░рж┐ржпрж╝ ржЯрзБ-ржбрзЛ ржжрзЗржЦрж╛ржи" ржЪрзЗржХржмржХрзНрж╕ржЯрж┐ ржЯрж┐ржХ ржжрзЗржУрзЯрж╛ рж╣ржпрж╝, рж╕ржорзНржкржирзНржи ржЯрзЛржбрзЛржЧрзБрж▓рж┐ рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржпрж╝ ржирж╛ред ржпрзЗ ржХрзЛржи ржЯрзЛржбрзЛ ржжрзГрж╢рзНржпржорж╛ржи рж╣рзЛржХ ржирж╛ ржХрзЗржи, ржлрзБржЯрж╛рж░рзЗ ржПржЦржиржУ рж╕ржорзНржкржирзНржи ржирж╛ рж╣ржУржпрж╝рж╛ ржЯрзЛржбрзЛржЧрзБрж▓рж┐рж░ рж╕ржВржЦрзНржпрж╛ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржпрж╝ред

ржПржЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ рж╕ржорж╕рзНржд ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╕рзНржЯрзЗржЯ ржПржмржВ ржЗржлрзЗржХрзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рзЗ рж╕рж░рж▓ ржХрж░рзБржиред

<Sandpack>

```js
import { useState, useEffect } from 'react';
import { initialTodos, createTodo } from './todos.js';

export default function TodoList() {
  const [todos, setTodos] = useState(initialTodos);
  const [showActive, setShowActive] = useState(false);
  const [activeTodos, setActiveTodos] = useState([]);
  const [visibleTodos, setVisibleTodos] = useState([]);
  const [footer, setFooter] = useState(null);

  useEffect(() => {
    setActiveTodos(todos.filter(todo => !todo.completed));
  }, [todos]);

  useEffect(() => {
    setVisibleTodos(showActive ? activeTodos : todos);
  }, [showActive, todos, activeTodos]);

  useEffect(() => {
    setFooter(
      <footer>
        {activeTodos.length} todos left
      </footer>
    );
  }, [activeTodos]);

  return (
    <>
      <label>
        <input
          type="checkbox"
          checked={showActive}
          onChange={e => setShowActive(e.target.checked)}
        />
        Show only active todos
      </label>
      <NewTodo onAdd={newTodo => setTodos([...todos, newTodo])} />
      <ul>
        {visibleTodos.map(todo => (
          <li key={todo.id}>
            {todo.completed ? <s>{todo.text}</s> : todo.text}
          </li>
        ))}
      </ul>
      {footer}
    </>
  );
}

function NewTodo({ onAdd }) {
  const [text, setText] = useState('');

  function handleAddClick() {
    setText('');
    onAdd(createTodo(text));
  }

  return (
    <>
      <input value={text} onChange={e => setText(e.target.value)} />
      <button onClick={handleAddClick}>
        Add
      </button>
    </>
  );
}
```

```js src/todos.js
let nextId = 0;

export function createTodo(text, completed = false) {
  return {
    id: nextId++,
    text,
    completed
  };
}

export const initialTodos = [
  createTodo('Get apples', true),
  createTodo('Get oranges', true),
  createTodo('Get carrots'),
];
```

```css
label { display: block; }
input { margin-top: 10px; }
```

</Sandpack>

<Hint>

ржпржжрж┐ ржЖржкржирж┐ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржХрж┐ржЫрзБ ржЧржгржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ ржЖржкржирж╛ржХрзЗ ржПржоржи рж╕рзНржЯрзЗржЯ ржмрж╛ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗ ржпрж╛ ржПржЯрж┐ ржЖржкржбрзЗржЯ ржХрж░рзЗред

</Hint>

<Solution>

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ ржжрзБржЯрж┐ ржорзВрж▓ рж╕рзНржЯрзЗржЯ рж░ржпрж╝рзЗржЫрзЗ: `todos` ржПрж░ рждрж╛рж▓рж┐ржХрж╛ ржПржмржВ `showActive` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржпрж╛ ржЪрзЗржХржмржХрзНрж╕ржЯрж┐ ржЯрж┐ржХ ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐ржирж╛ рждрж╛ ржкрзНрж░рждрж┐ржирж┐ржзрж┐рждрзНржм ржХрж░рзЗред ржЕржирзНржпрж╛ржирзНржп рж╕ржорж╕рзНржд рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ [ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝](/learn/choosing-the-state-structure#avoid-redundant-state) ржПржмржВ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржЧржгржирж╛ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред ржПрж░ ржоржзрзНржпрзЗ `footer` ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржпрж╛ ржЖржкржирж┐ рж╕рж░рж╛рж╕рж░рж┐ ржЪрж╛рж░ржкрж╛рж╢рзЗрж░ JSX-рждрзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

ржЖржкржирж╛рж░ ржлрж▓рж╛ржлрж▓ржЯрж┐ ржПрж░ржХржо рж╣ржмрзЗ:

<Sandpack>

```js
import { useState } from 'react';
import { initialTodos, createTodo } from './todos.js';

export default function TodoList() {
  const [todos, setTodos] = useState(initialTodos);
  const [showActive, setShowActive] = useState(false);
  const activeTodos = todos.filter(todo => !todo.completed);
  const visibleTodos = showActive ? activeTodos : todos;

  return (
    <>
      <label>
        <input
          type="checkbox"
          checked={showActive}
          onChange={e => setShowActive(e.target.checked)}
        />
        Show only active todos
      </label>
      <NewTodo onAdd={newTodo => setTodos([...todos, newTodo])} />
      <ul>
        {visibleTodos.map(todo => (
          <li key={todo.id}>
            {todo.completed ? <s>{todo.text}</s> : todo.text}
          </li>
        ))}
      </ul>
      <footer>
        {activeTodos.length} todos left
      </footer>
    </>
  );
}

function NewTodo({ onAdd }) {
  const [text, setText] = useState('');

  function handleAddClick() {
    setText('');
    onAdd(createTodo(text));
  }

  return (
    <>
      <input value={text} onChange={e => setText(e.target.value)} />
      <button onClick={handleAddClick}>
        Add
      </button>
    </>
  );
}
```

```js src/todos.js
let nextId = 0;

export function createTodo(text, completed = false) {
  return {
    id: nextId++,
    text,
    completed
  };
}

export const initialTodos = [
  createTodo('Get apples', true),
  createTodo('Get oranges', true),
  createTodo('Get carrots'),
];
```

```css
label { display: block; }
input { margin-top: 10px; }
```

</Sandpack>

</Solution>

#### ржПржлрзЗржХрзНржЯ ржЫрзЬрж╛ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗрж╢ ржХрзНржпрж╛рж╢ ржХрж░рж╛ {/*cache-a-calculation-without-effects*/}

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, ржЯрзЛржбрзЛржЧрзБрж▓рж┐ржХрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржкрзГржержХ ржлрж╛ржВрж╢ржи `getVisibleTodos()` ржП рж╕рзНржерж╛ржирж╛ржирзНрждрж░рж┐ржд ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржПржЗ ржлрж╛ржВрж╢ржирзЗрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ `console.log()` ржХрж▓ рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ ржЖржкржирж╛ржХрзЗ ржжрзЗржЦрж╛рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ ржХржЦржи ржПржЯрж┐ ржХрж▓ рж╣ржЪрзНржЫрзЗред "рж╢рзБржзрзБржорж╛рждрзНрж░ рж╕ржХрзНрж░рж┐ржпрж╝ ржЯрзЛржбрзЛ ржжрзЗржЦрж╛ржи" ржЯржЧрж▓ ржХрж░рж▓рзЗ рж▓ржХрзНрж╖рзНржп ржХрж░рзБржи ржпрзЗ ржПржЯрж┐ `getVisibleTodos()` ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рж╛ржирзЛрж░ ржХрж╛рж░ржг рж╣ржпрж╝ред ржПржЯрж┐ ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржХрж╛рж░ржг ржЖржкржирж┐ ржХрзЛржи ржЯрзЛржбрзЛржЧрзБрж▓рж┐ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░ржмрзЗржи рждрж╛ ржЯржЧрж▓ ржХрж░рж▓рзЗ ржжрзГрж╢рзНржпржорж╛ржи ржЯрзЛржбрзЛржЧрзБрж▓рж┐ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝ред

ржЖржкржирж╛рж░ ржХрж╛ржЬ рж╣рж▓ `TodoList` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ `visibleTodos` рждрж╛рж▓рж┐ржХрж╛ ржкрзБржиржГржЧржгржирж╛ ржХрж░рж╛ ржЗржлрзЗржХрзНржЯржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ред рждржмрзЗ, ржЖржкржирж╛ржХрзЗ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рждрзЗ рж╣ржмрзЗ ржпрзЗ `getVisibleTodos()` *ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рж╛ржирзЛ рж╣ржпрж╝ ржирж╛* (ржПржмржВ рждрж╛ржЗ ржХрзЛржиржУ рж▓ржЧ ржорзБржжрзНрж░ржг ржХрж░рзЗ ржирж╛) ржпржЦржи ржЖржкржирж┐ ржЗржиржкрзБржЯрзЗ ржЯрж╛ржЗржк ржХрж░рзЗржиред

<Hint>

ржПржХржЯрж┐ рж╕ржорж╛ржзрж╛ржи рж╣рж▓ ржжрзГрж╢рзНржпржорж╛ржи ржЯрзЛржбрзЛржЧрзБрж▓рж┐ржХрзЗ ржХрзНржпрж╛рж╢ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ `useMemo` ржХрж▓ ржпрзБржХрзНржд ржХрж░рж╛ред ржПржХржЯрж┐ ржЕржирзНржп, ржХржо рж╕рзНржкрж╖рзНржЯ рж╕ржорж╛ржзрж╛ржиржУ рж░ржпрж╝рзЗржЫрзЗред

</Hint>

<Sandpack>

```js
import { useState, useEffect } from 'react';
import { initialTodos, createTodo, getVisibleTodos } from './todos.js';

export default function TodoList() {
  const [todos, setTodos] = useState(initialTodos);
  const [showActive, setShowActive] = useState(false);
  const [text, setText] = useState('');
  const [visibleTodos, setVisibleTodos] = useState([]);

  useEffect(() => {
    setVisibleTodos(getVisibleTodos(todos, showActive));
  }, [todos, showActive]);

  function handleAddClick() {
    setText('');
    setTodos([...todos, createTodo(text)]);
  }

  return (
    <>
      <label>
        <input
          type="checkbox"
          checked={showActive}
          onChange={e => setShowActive(e.target.checked)}
        />
        Show only active todos
      </label>
      <input value={text} onChange={e => setText(e.target.value)} />
      <button onClick={handleAddClick}>
        Add
      </button>
      <ul>
        {visibleTodos.map(todo => (
          <li key={todo.id}>
            {todo.completed ? <s>{todo.text}</s> : todo.text}
          </li>
        ))}
      </ul>
    </>
  );
}
```

```js src/todos.js
let nextId = 0;
let calls = 0;

export function getVisibleTodos(todos, showActive) {
  console.log(`getVisibleTodos() was called ${++calls} times`);
  const activeTodos = todos.filter(todo => !todo.completed);
  const visibleTodos = showActive ? activeTodos : todos;
  return visibleTodos;
}

export function createTodo(text, completed = false) {
  return {
    id: nextId++,
    text,
    completed
  };
}

export const initialTodos = [
  createTodo('Get apples', true),
  createTodo('Get oranges', true),
  createTodo('Get carrots'),
];
```

```css
label { display: block; }
input { margin-top: 10px; }
```

</Sandpack>

<Solution>

рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржПржмржВ ржЗржлрзЗржХрзНржЯржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржи, ржПржмржВ ржкрж░рж┐ржмрж░рзНрждрзЗ `getVisibleTodos()` ржХрж▓ ржХрж░рж╛рж░ ржлрж▓рж╛ржлрж▓ ржХрзНржпрж╛рж╢ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ `useMemo` ржХрж▓ ржпрзБржХрзНржд ржХрж░рзБржи:

<Sandpack>

```js
import { useState, useMemo } from 'react';
import { initialTodos, createTodo, getVisibleTodos } from './todos.js';

export default function TodoList() {
  const [todos, setTodos] = useState(initialTodos);
  const [showActive, setShowActive] = useState(false);
  const [text, setText] = useState('');
  const visibleTodos = useMemo(
    () => getVisibleTodos(todos, showActive),
    [todos, showActive]
  );

  function handleAddClick() {
    setText('');
    setTodos([...todos, createTodo(text)]);
  }

  return (
    <>
      <label>
        <input
          type="checkbox"
          checked={showActive}
          onChange={e => setShowActive(e.target.checked)}
        />
        Show only active todos
      </label>
      <input value={text} onChange={e => setText(e.target.value)} />
      <button onClick={handleAddClick}>
        Add
      </button>
      <ul>
        {visibleTodos.map(todo => (
          <li key={todo.id}>
            {todo.completed ? <s>{todo.text}</s> : todo.text}
          </li>
        ))}
      </ul>
    </>
  );
}
```

```js src/todos.js
let nextId = 0;
let calls = 0;

export function getVisibleTodos(todos, showActive) {
  console.log(`getVisibleTodos() was called ${++calls} times`);
  const activeTodos = todos.filter(todo => !todo.completed);
  const visibleTodos = showActive ? activeTodos : todos;
  return visibleTodos;
}

export function createTodo(text, completed = false) {
  return {
    id: nextId++,
    text,
    completed
  };
}

export const initialTodos = [
  createTodo('Get apples', true),
  createTodo('Get oranges', true),
  createTodo('Get carrots'),
];
```

```css
label { display: block; }
input { margin-top: 10px; }
```

</Sandpack>

ржПржЗ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ рж╕рж╛ржерзЗ, `getVisibleTodos()` ржХрзЗржмрж▓ рждржЦржиржЗ ржХрж▓ рж╣ржмрзЗ ржпржжрж┐ `todos` ржЕржержмрж╛ `showActive` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝ред ржЗржиржкрзБржЯрзЗ ржЯрж╛ржЗржк ржХрж░рж╛ ржХрзЗржмрж▓ `text` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ, рждрж╛ржЗ ржПржЯрж┐ `getVisibleTodos()` ржХрзЗ ржХрж▓ ржХрж░рждрзЗ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░рзЗ ржирж╛ред

ржЖрж░ржУ ржПржХржЯрж┐ рж╕ржорж╛ржзрж╛ржи рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ `useMemo` ржПрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред ржпрзЗрж╣рзЗрждрзБ `text` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ рж╕ржорзНржнржмржд ржЯрзЛржбрзЛрж░ рждрж╛рж▓рж┐ржХрж╛ржХрзЗ ржкрзНрж░ржнрж╛ржмрж┐ржд ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржирж╛, ржЖржкржирж┐ `NewTodo` ржлрж░рзНржоржЯрж┐ржХрзЗ ржПржХржЯрж┐ ржкрзГржержХ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░рж┐ржд ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржмржВ `text` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ржХрзЗ ржПрж░ ржнрж┐рждрж░рзЗ ржирж┐ржпрж╝рзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗржи:

<Sandpack>

```js
import { useState, useMemo } from 'react';
import { initialTodos, createTodo, getVisibleTodos } from './todos.js';

export default function TodoList() {
  const [todos, setTodos] = useState(initialTodos);
  const [showActive, setShowActive] = useState(false);
  const visibleTodos = getVisibleTodos(todos, showActive);

  return (
    <>
      <label>
        <input
          type="checkbox"
          checked={showActive}
          onChange={e => setShowActive(e.target.checked)}
        />
        Show only active todos
      </label>
      <NewTodo onAdd={newTodo => setTodos([...todos, newTodo])} />
      <ul>
        {visibleTodos.map(todo => (
          <li key={todo.id}>
            {todo.completed ? <s>{todo.text}</s> : todo.text}
          </li>
        ))}
      </ul>
    </>
  );
}

function NewTodo({ onAdd }) {
  const [text, setText] = useState('');

  function handleAddClick() {
    setText('');
    onAdd(createTodo(text));
  }

  return (
    <>
      <input value={text} onChange={e => setText(e.target.value)} />
      <button onClick={handleAddClick}>
        Add
      </button>
    </>
  );
}
```

```js src/todos.js
let nextId = 0;
let calls = 0;

export function getVisibleTodos(todos, showActive) {
  console.log(`getVisibleTodos() was called ${++calls} times`);
  const activeTodos = todos.filter(todo => !todo.completed);
  const visibleTodos = showActive ? activeTodos : todos;
  return visibleTodos;
}

export function createTodo(text, completed = false) {
  return {
    id: nextId++,
    text,
    completed
  };
}

export const initialTodos = [
  createTodo('Get apples', true),
  createTodo('Get oranges', true),
  createTodo('Get carrots'),
];
```

```css
label { display: block; }
input { margin-top: 10px; }
```

</Sandpack>

ржПржЗ ржкржжрзНржзрждрж┐ржЯрж┐ ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛ ржорзЗржЯрж╛рзЯред ржпржЦржи ржЖржкржирж┐ ржЗржиржкрзБржЯрзЗ ржЯрж╛ржЗржк ржХрж░рзЗржи, ржХрзЗржмрж▓ `text` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржЖржкржбрзЗржЯ рж╣ржпрж╝ред ржпрзЗрж╣рзЗрждрзБ `text` рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ рж╕ржирзНрждрж╛ржирзЗрж░ `NewTodo` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржЖржЫрзЗ, рждрж╛ржЗ ржЕржнрж┐ржнрж╛ржмржХ `TodoList` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗ ржирж╛ред ржП ржХрж╛рж░ржгрзЗржЗ ржЖржкржирж┐ ржЯрж╛ржЗржк ржХрж░рж╛рж░ рж╕ржоржпрж╝ `getVisibleTodos()` ржХрж▓ рж╣ржпрж╝ ржирж╛ред (ржпржжрж┐ `TodoList` ржЕржирзНржп ржХрзЛржиржУ ржХрж╛рж░ржгрзЗ ржкрзБржирж░рж╛ржпрж╝ рж░рзЗржирзНржбрж╛рж░ рж╣ржпрж╝ рждржмрзЗ ржПржЯрж┐ ржПржЦржиржУ ржХрж▓ рж╣ржмрзЗред)

</Solution>

#### ржЗржлрзЗржХрзНржЯ ржЫрж╛рзЬрж╛ рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛ {/*reset-state-without-effects*/}

ржПржЗ `EditContact` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ `{ id, name, email }` ржЖржХрж╛рж░рзЗрж░ ржПржХржЯрж┐ ржпрзЛржЧрж╛ржпрзЛржЧ ржЕржмржЬрзЗржХрзНржЯ `savedContact` ржкрзНрж░ржк рж╣рж┐рж╕рзЗржмрзЗ ржЧрзНрж░рж╣ржг ржХрж░рзЗред ржирж╛ржо ржПржмржВ ржЗржорзЗржЗрж▓ ржЗржиржкрзБржЯ ржлрж┐рж▓рзНржбржЧрзБрж▓рж┐ рж╕ржорзНржкрж╛ржжржирж╛ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред ржЖржкржирж┐ ржпржЦржи рж╕рзЗржн ржЪрж╛ржкрзЗржи, ржлрж░рзНржорзЗрж░ ржЙржкрж░рзЗ ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржмрж╛ржЯржиржЯрж┐ рж╕ржорзНржкрж╛ржжрж┐ржд ржирж╛ржорзЗрж░ рж╕рж╛ржерзЗ ржЖржкржбрзЗржЯ рж╣ржпрж╝ред ржЖржкржирж┐ ржпржЦржи рж░рж┐рж╕рзЗржЯ ржЪрж╛ржкрзЗржи, ржлрж░рзНржорзЗ ржХрзЛржиржУ ржЪрж▓ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржи ржмрж╛рждрж┐рж▓ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ред ржПржЯрж┐ ржЕржирзБржнржм ржХрж░рж╛рж░ ржЬржирзНржп ржПржЗ UI-рждрзЗ ржЦрзЗрж▓рж╛ ржХрж░рзБржиред

ржЖржкржирж┐ ржпржЦржи ржЙржкрж░рзЗрж░ ржмрж╛ржЯржиржЧрзБрж▓рж┐рж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ ржПржХржЯрж┐ ржпрзЛржЧрж╛ржпрзЛржЧ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзЗржи, ржлрж░рзНржоржЯрж┐ рж╕рзЗржЗ ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд рждржерзНржп ржкрзНрж░рждрж┐ржлрж▓рж┐ржд ржХрж░рждрзЗ рж░рж┐рж╕рзЗржЯ рж╣ржпрж╝ред ржПржЯрж┐ `EditContact.js` ржПрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржЗржлрзЗржХрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЗ ржЗржлрзЗржХрзНржЯржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржиред `savedContact.id` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ ржлрж░рзНржоржЯрж┐ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржЖрж░рзЗржХржЯрж┐ ржЙржкрж╛ржпрж╝ ржЦрзБржБржЬрзБржиред

<Sandpack>

```js src/App.js hidden
import { useState } from 'react';
import ContactList from './ContactList.js';
import EditContact from './EditContact.js';

export default function ContactManager() {
  const [
    contacts,
    setContacts
  ] = useState(initialContacts);
  const [
    selectedId,
    setSelectedId
  ] = useState(0);
  const selectedContact = contacts.find(c =>
    c.id === selectedId
  );

  function handleSave(updatedData) {
    const nextContacts = contacts.map(c => {
      if (c.id === updatedData.id) {
        return updatedData;
      } else {
        return c;
      }
    });
    setContacts(nextContacts);
  }

  return (
    <div>
      <ContactList
        contacts={contacts}
        selectedId={selectedId}
        onSelect={id => setSelectedId(id)}
      />
      <hr />
      <EditContact
        savedContact={selectedContact}
        onSave={handleSave}
      />
    </div>
  )
}

const initialContacts = [
  { id: 0, name: 'Taylor', email: 'taylor@mail.com' },
  { id: 1, name: 'Alice', email: 'alice@mail.com' },
  { id: 2, name: 'Bob', email: 'bob@mail.com' }
];
```

```js src/ContactList.js hidden
export default function ContactList({
  contacts,
  selectedId,
  onSelect
}) {
  return (
    <section>
      <ul>
        {contacts.map(contact =>
          <li key={contact.id}>
            <button onClick={() => {
              onSelect(contact.id);
            }}>
              {contact.id === selectedId ?
                <b>{contact.name}</b> :
                contact.name
              }
            </button>
          </li>
        )}
      </ul>
    </section>
  );
}
```

```js src/EditContact.js active
import { useState, useEffect } from 'react';

export default function EditContact({ savedContact, onSave }) {
  const [name, setName] = useState(savedContact.name);
  const [email, setEmail] = useState(savedContact.email);

  useEffect(() => {
    setName(savedContact.name);
    setEmail(savedContact.email);
  }, [savedContact]);

  return (
    <section>
      <label>
        Name:{' '}
        <input
          type="text"
          value={name}
          onChange={e => setName(e.target.value)}
        />
      </label>
      <label>
        Email:{' '}
        <input
          type="email"
          value={email}
          onChange={e => setEmail(e.target.value)}
        />
      </label>
      <button onClick={() => {
        const updatedData = {
          id: savedContact.id,
          name: name,
          email: email
        };
        onSave(updatedData);
      }}>
        Save
      </button>
      <button onClick={() => {
        setName(savedContact.name);
        setEmail(savedContact.email);
      }}>
        Reset
      </button>
    </section>
  );
}
```

```css
ul, li {
  list-style: none;
  margin: 0;
  padding: 0;
}
li { display: inline-block; }
li button {
  padding: 10px;
}
label {
  display: block;
  margin: 10px 0;
}
button {
  margin-right: 10px;
  margin-bottom: 10px;
}
```

</Sandpack>

<Hint>

ржПржЯрж┐ ржЦрзБржмржЗ ржнрж╛рж▓рзЛ рж╣ржмрзЗ ржпржжрж┐ ржХрзЛржиржУ ржЙржкрж╛ржпрж╝ ржерж╛ржХржд ржпрж╛ рж░рж┐ржЕрзНржпрж╛ржХрзНржЯржХрзЗ ржмрж▓рждрзЗ ржкрж╛рж░рзЗ ржпрзЗ `savedContact.id` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ `EditContact` ржлрж░рзНржоржЯрж┐ ржзрж╛рж░ржгрж╛ржЧрждржнрж╛ржмрзЗ ржПржХржЯрж┐ _ржмрж┐ржнрж┐ржирзНржи ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржлрж░рзНржо_ ржПржмржВ ржПржЯрж┐ рж╕рзНржЯрзЗржЯ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛ ржЙржЪрж┐ржд ржиржпрж╝ред ржЖржкржирж┐ ржХрж┐ ржПржоржи ржХрзЛржиржУ ржЙржкрж╛ржпрж╝ ржоржирзЗ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи?

</Hint>

<Solution>

`EditContact` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ржХрзЗ ржжрзБржЯрж┐ ржЕржВрж╢рзЗ ржнрж╛ржЧ ржХрж░рзБржиред рж╕ржорж╕рзНржд ржлрж░рзНржо рж╕рзНржЯрзЗржЯржХрзЗ ржЕржнрзНржпржирзНрждрж░рзАржг `EditForm` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░рж┐ржд ржХрж░рзБржиред ржмрж╛ржЗрж░рзЗрж░ `EditContact` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рзБржи ржПржмржВ ржПржЯрж┐ ржЕржнрзНржпржирзНрждрж░рзАржг `EditForm` ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ `savedContact.id` ржХрзЗ `key` рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛ржарж╛рждрзЗ ржмрж▓рзБржиред ржПрж░ ржлрж▓рж╕рзНржмрж░рзВржк, ржЕржнрзНржпржирзНрждрж░рзАржг `EditForm` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржпржЦржи ржЖржкржирж┐ ржПржХржЯрж┐ ржнрж┐ржирзНржи ржпрзЛржЧрж╛ржпрзЛржЧ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзЗржи, рждржЦржи рж╕ржорж╕рзНржд ржлрж░рзНржо рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рзЗ ржПржмржВ DOM ржкрзБржирж░рж╛ржпрж╝ рждрзИрж░рж┐ ржХрж░рзЗред

<Sandpack>

```js src/App.js hidden
import { useState } from 'react';
import ContactList from './ContactList.js';
import EditContact from './EditContact.js';

export default function ContactManager() {
  const [
    contacts,
    setContacts
  ] = useState(initialContacts);
  const [
    selectedId,
    setSelectedId
  ] = useState(0);
  const selectedContact = contacts.find(c =>
    c.id === selectedId
  );

  function handleSave(updatedData) {
    const nextContacts = contacts.map(c => {
      if (c.id === updatedData.id) {
        return updatedData;
      } else {
        return c;
      }
    });
    setContacts(nextContacts);
  }

  return (
    <div>
      <ContactList
        contacts={contacts}
        selectedId={selectedId}
        onSelect={id => setSelectedId(id)}
      />
      <hr />
      <EditContact
        savedContact={selectedContact}
        onSave={handleSave}
      />
    </div>
  )
}

const initialContacts = [
  { id: 0, name: 'Taylor', email: 'taylor@mail.com' },
  { id: 1, name: 'Alice', email: 'alice@mail.com' },
  { id: 2, name: 'Bob', email: 'bob@mail.com' }
];
```

```js src/ContactList.js hidden
export default function ContactList({
  contacts,
  selectedId,
  onSelect
}) {
  return (
    <section>
      <ul>
        {contacts.map(contact =>
          <li key={contact.id}>
            <button onClick={() => {
              onSelect(contact.id);
            }}>
              {contact.id === selectedId ?
                <b>{contact.name}</b> :
                contact.name
              }
            </button>
          </li>
        )}
      </ul>
    </section>
  );
}
```

```js src/EditContact.js active
import { useState } from 'react';

export default function EditContact(props) {
  return (
    <EditForm
      {...props}
      key={props.savedContact.id}
    />
  );
}

function EditForm({ savedContact, onSave }) {
  const [name, setName] = useState(savedContact.name);
  const [email, setEmail] = useState(savedContact.email);

  return (
    <section>
      <label>
        Name:{' '}
        <input
          type="text"
          value={name}
          onChange={e => setName(e.target.value)}
        />
      </label>
      <label>
        Email:{' '}
        <input
          type="email"
          value={email}
          onChange={e => setEmail(e.target.value)}
        />
      </label>
      <button onClick={() => {
        const updatedData = {
          id: savedContact.id,
          name: name,
          email: email
        };
        onSave(updatedData);
      }}>
        Save
      </button>
      <button onClick={() => {
        setName(savedContact.name);
        setEmail(savedContact.email);
      }}>
        Reset
      </button>
    </section>
  );
}
```

```css
ul, li {
  list-style: none;
  margin: 0;
  padding: 0;
}
li { display: inline-block; }
li button {
  padding: 10px;
}
label {
  display: block;
  margin: 10px 0;
}
button {
  margin-right: 10px;
  margin-bottom: 10px;
}
```

</Sandpack>

</Solution>

#### ржПржлрзЗржХрзНржЯ ржЫрж╛ржбрж╝рж╛ ржлрж░рзНржо рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛ {/*submit-a-form-without-effects*/}

ржПржЗ `Form` ржЙржкрж╛ржжрж╛ржиржЯрж┐ ржЖржкржирж╛ржХрзЗ ржПржХржЯрж┐ ржмржирзНржзрзБржжрзЗрж░ ржХрж╛ржЫрзЗ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржирзЛрж░ рж╕рзБржпрзЛржЧ ржжрзЗржпрж╝ред ржпржЦржи ржЖржкржирж┐ ржлрж░рзНржоржЯрж┐ ржЬржорж╛ ржжрзЗржи, `showForm` рж░рж╛рж╖рзНржЯрзНрж░ ржкрж░рж┐ржмрж░рзНрждржирж╢рзАрж▓ржЯрж┐ `false` рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЯрж┐ ржПржХржЯрж┐ ржкрзНрж░ржнрж╛ржмржХрзЗ рж╕ржХрзНрж░рж┐ржпрж╝ ржХрж░рзЗ ржпрж╛ `sendMessage(message)` ржХрж▓ ржХрж░рзЗ, ржпрж╛ ржмрж╛рж░рзНрждрж╛ржЯрж┐ ржкрж╛ржарж╛ржпрж╝ (ржЖржкржирж┐ ржПржЯрж┐ ржХржирж╕рзЛрж▓рзЗ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржи)ред ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржирзЛрж░ ржкрж░рзЗ, ржЖржкржирж┐ ржПржХржЯрж┐ "ржзржирзНржпржмрж╛ржж" рж╕ржВрж▓рж╛ржк ржжрзЗржЦржмрзЗржи ржпрж╛рж░ ржПржХржЯрж┐ "ржЪрзНржпрж╛ржЯ ржЦрзБрж▓рзБржи" ржмрзЛрждрж╛ржо рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ ржЖржкржирж╛ржХрзЗ ржЖржмрж╛рж░ ржлрж░рзНржорзЗ ржлрж┐рж░рж┐ржпрж╝рзЗ ржирж┐ржпрж╝рзЗ ржпрж╛ржпрж╝ред

ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░рж╛ ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржЪрзНржЫрзЗржиред ржЪрзНржпрж╛ржЯрж┐ржВржХрзЗ ржХрж┐ржЫрзБржЯрж╛ ржЖрж░ржУ ржХржарж┐ржи ржХрж░рж╛рж░ ржЬржирзНржп, ржЖржкржирж┐ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирж┐ржпрж╝рзЗржЫрзЗржи ржпрзЗ "ржзржирзНржпржмрж╛ржж" рж╕ржВрж▓рж╛ржкржЯрж┐ *ржкрзНрж░ржержорзЗ* ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░ржмрзЗржи ржлрж░рзНржорзЗрж░ ржкрж░рж┐ржмрж░рзНрждрзЗред ржПржЗ ржкрж░рж┐ржмрж░рзНрждржиржЯрж┐ ржХрж░рж╛рж░ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗржЗ `showForm` рж░рж╛рж╖рзНржЯрзНрж░ ржкрж░рж┐ржмрж░рзНрждржирж╢рзАрж▓ржЯрж┐ржХрзЗ `true` ржерзЗржХрзЗ `false`рждрзЗ рж╕рзЗржЯ ржХрж░рзБржиред ржпржЦржи ржЖржкржирж┐ ржПржЗ ржкрж░рж┐ржмрж░рзНрждржиржЯрж┐ ржХрж░ржмрзЗржи, ржХржирж╕рзЛрж▓рзЗ ржПржХржЯрж┐ ржЦрж╛рж▓рж┐ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ ржПржоржи ржПржХржЯрж┐ ржмрж╛рж░рзНрждрж╛ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржмрзЗред ржПржЗ рж▓ржЬрж┐ржХрзЗ ржХрж┐ржЫрзБ ржнрзБрж▓ рж░ржпрж╝рзЗржЫрзЗ!

рж╕ржорж╕рзНржпрж╛рж░ ржорзВрж▓ ржХрж╛рж░ржг ржХрзА? ржПржмржВ ржЖржкржирж┐ ржПржЯрж┐ ржХрж┐ржнрж╛ржмрзЗ ржарж┐ржХ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи?

<Hint>

Should the message be sent _because_ the user saw the "Thank you" dialog? Or is it the other way around ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА "ржзржирзНржпржмрж╛ржж" ржжрзЗржЦрж╛рж░ _ржХрж╛рж░ржгрзЗ_ ржорзЗрж╕рзЗржЬржЯрж┐ ржкрж╛ржарж╛ржирзЛ ржЙржЪрж┐ржд ржХрж┐? ржирж╛ржХрж┐ ржЙрж▓рзНржЯрзЛржЯрж╛?

</Hint>

<Sandpack>

```js
import { useState, useEffect } from 'react';

export default function Form() {
  const [showForm, setShowForm] = useState(true);
  const [message, setMessage] = useState('');

  useEffect(() => {
    if (!showForm) {
      sendMessage(message);
    }
  }, [showForm, message]);

  function handleSubmit(e) {
    e.preventDefault();
    setShowForm(false);
  }

  if (!showForm) {
    return (
      <>
        <h1>Thanks for using our services!</h1>
        <button onClick={() => {
          setMessage('');
          setShowForm(true);
        }}>
          Open chat
        </button>
      </>
    );
  }

  return (
    <form onSubmit={handleSubmit}>
      <textarea
        placeholder="Message"
        value={message}
        onChange={e => setMessage(e.target.value)}
      />
      <button type="submit" disabled={message === ''}>
        Send
      </button>
    </form>
  );
}

function sendMessage(message) {
  console.log('Sending message: ' + message);
}
```

```css
label, textarea { margin-bottom: 10px; display: block; }
```

</Sandpack>

<Solution>

`showForm` рж░рж╛рж╖рзНржЯрзНрж░ ржкрж░рж┐ржмрж░рзНрждржирж╢рзАрж▓ржЯрж┐ ржлрж░рзНржо ржмрж╛ "ржзржирзНржпржмрж╛ржж" рж╕ржВрж▓рж╛ржкржЯрж┐ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рж╛ рж╣ржмрзЗ ржХрж┐ржирж╛ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗред рждржмрзЗ, ржЖржкржирж┐ ржмрж╛рж░рзНрждрж╛ржЯрж┐ ржкрж╛ржарж╛ржЪрзНржЫрзЗржи ржирж╛ ржХрж╛рж░ржг "ржзржирзНржпржмрж╛ржж" рж╕ржВрж▓рж╛ржкржЯрж┐ _ржкрзНрж░ржжрж░рзНрж╢рж┐ржд_ рж╣ржпрж╝рзЗржЫрзЗред ржЖржкржирж┐ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛рждрзЗ ржЪрж╛ржи ржХрж╛рж░ржг ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА _ржлрж░рзНржоржЯрж┐ ржЬржорж╛ ржжрж┐ржпрж╝рзЗржЫрзЗред_ ржмрж┐ржнрзНрж░рж╛ржирзНрждрж┐ржХрж░ ржкрзНрж░ржнрж╛ржмржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзБржи ржПржмржВ `sendMessage` ржХрж▓ржЯрж┐ржХрзЗ `handleSubmit` ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗрж░ ржнрж┐рждрж░рзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░ ржХрж░рзБржи:

<Sandpack>

```js
import { useState, useEffect } from 'react';

export default function Form() {
  const [showForm, setShowForm] = useState(true);
  const [message, setMessage] = useState('');

  function handleSubmit(e) {
    e.preventDefault();
    setShowForm(false);
    sendMessage(message);
  }

  if (!showForm) {
    return (
      <>
        <h1>Thanks for using our services!</h1>
        <button onClick={() => {
          setMessage('');
          setShowForm(true);
        }}>
          Open chat
        </button>
      </>
    );
  }

  return (
    <form onSubmit={handleSubmit}>
      <textarea
        placeholder="Message"
        value={message}
        onChange={e => setMessage(e.target.value)}
      />
      <button type="submit" disabled={message === ''}>
        Send
      </button>
    </form>
  );
}

function sendMessage(message) {
  console.log('Sending message: ' + message);
}
```

```css
label, textarea { margin-bottom: 10px; display: block; }
```

</Sandpack>

ржжрзЗржЦрзБржи, ржПржЗ рж╕ржВрж╕рзНржХрж░ржгрзЗ, рж╢рзБржзрзБржорж╛рждрзНрж░ _ржлрж░рзНржоржЯрж┐ ржЬржорж╛ ржжрзЗржУржпрж╝рж╛_ (ржпрж╛ ржПржХржЯрж┐ ржЗржнрзЗржирзНржЯ) ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржирзЛрж░ ржХрж╛рж░ржг рж╣ржпрж╝ред ржПржЯрж┐ `showForm` ржпржжрж┐ ржкрзНрж░рж╛ржержорж┐ржХржнрж╛ржмрзЗ `true` ржмрж╛ `false` рж╣рж┐рж╕рж╛ржмрзЗ рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝, ржЙржнржпрж╝ ржХрзНрж╖рзЗрждрзНрж░рзЗржЗ рж╕ржорж╛ржиржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред (ржПржЯрж┐ `false` ржП рж╕рзЗржЯ ржХрж░рзБржи ржПржмржВ ржжрзЗржЦрзБржи ржЕрждрж┐рж░рж┐ржХрзНржд ржХржирж╕рзЛрж▓ ржмрж╛рж░рзНрждрж╛ ржирзЗржЗред)

</Solution>

</Challenges>
